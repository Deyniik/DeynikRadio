<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deynik Radio</title>
    
    <!-- Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ PWA Ð¼Ð°Ð½Ð¸Ñ„ÐµÑÑ‚ -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Ð˜ÐºÐ¾Ð½ÐºÐ¸ Ð´Ð»Ñ PWA -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icon-512x512.png">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Pacifico&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    
    <!-- ÐœÐµÑ‚Ð°-Ñ‚ÐµÐ³Ð¸ Ð´Ð»Ñ ÐºÑ€Ð°ÑÐ¸Ð²Ð¾Ð³Ð¾ ÑˆÐ°Ñ€Ð¸Ð½Ð³Ð° -->
    <meta property="og:title" content="Deynik Radio">
    <meta property="og:description" content="Ð¡Ð»ÑƒÑˆÐ°Ð¹Ñ‚Ðµ Ð»ÑƒÑ‡ÑˆÐ¸Ðµ Ñ€Ð°Ð´Ð¸Ð¾ÑÑ‚Ð°Ð½Ñ†Ð¸Ð¸ Ð² ÑÑ‚Ð¸Ð»ÑŒÐ½Ð¾Ð¼ Ñ€ÐµÑ‚Ñ€Ð¾-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐµ">
    <meta property="og:image" content="https://i.pinimg.com/originals/7d/04/0e/7d040e94931427709008aaeda14db9c8.gif">
    <meta property="og:url" content="https://deyniik.github.io/DeynikRadio/">
    <meta name="twitter:card" content="summary_large_image">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }
        
        body {
            background-color: #121212;
            color: #FFFFFF;
            height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 12px;
            overflow: hidden;
            transition: background-color 0.5s ease, color 0.5s ease;
        }
        
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #121212;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-gif {
            width: 200px;
            height: 200px;
            background: url('https://i.pinimg.com/originals/3b/06/ee/3b06ee2cc6a317ccdc098b4ab36a8388.gif') center/cover no-repeat;
        }
        
        .loading-text {
            margin-top: 20px;
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            font-weight: 700;
            color: #1DB954;
            text-shadow: 0 0 10px rgba(29, 185, 84, 0.7);
            letter-spacing: 1px;
            animation: flicker 1.5s infinite alternate;
        }
        
        @keyframes flicker {
            0%, 19%, 21%, 23%, 25%, 27%, 29%, 31%, 33%, 35%, 37%, 39%, 80%, 100% {
                opacity: 1;
                text-shadow: 0 0 10px rgba(29, 185, 84, 0.7), 0 0 20px rgba(29, 185, 84, 0.5);
            }
            20%, 22%, 24%, 26%, 28%, 30%, 32%, 34%, 36%, 38%, 40%, 60% {
                opacity: 0.6;
                text-shadow: 0 0 5px rgba(29, 185, 84, 0.5);
            }
            65%, 70%, 75% {
                opacity: 0.9;
                text-shadow: 0 0 15px rgba(29, 185, 84, 0.6), 0 0 25px rgba(29, 185, 84, 0.4);
            }
            85%, 90%, 95% {
                opacity: 0.7;
                text-shadow: 0 0 8px rgba(29, 185, 84, 0.6);
            }
        }
        
        .container {
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
            max-height: 100vh;
            display: none;
        }
        
        header {
            text-align: center;
            padding: 8px 0;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-shrink: 0;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
            justify-content: flex-start;
        }
        
        .header-center {
            flex: 2;
            display: flex;
            justify-content: center;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
            justify-content: flex-end;
        }
        
        .google-login-btn {
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .google-login-btn:hover {
            background: rgba(29, 185, 84, 0.3);
            transform: scale(1.05);
        }
        
        .lite-switch {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 10px;
        }

        .lite-switch-label {
            font-size: 0.8rem;
            color: #B3B3B3;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 20px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #1DB954;
        }

        input:checked + .slider:before {
            transform: translateX(20px);
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 5px 12px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .user-profile:hover {
            background: rgba(29, 185, 84, 0.3);
            transform: scale(1.05);
        }
        
        .user-avatar {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: linear-gradient(135deg, #1DB954 0%, #191414 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }
        
        .user-name {
            font-size: 0.8rem;
            max-width: 100px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .edit-nickname-btn {
            background: transparent;
            border: none;
            color: #B3B3B3;
            cursor: pointer;
            font-size: 0.7rem;
            transition: all 0.3s ease;
            padding: 2px;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .edit-nickname-btn:hover {
            color: #1DB954;
            background: rgba(29, 185, 84, 0.1);
        }
        
        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(40, 40, 40, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 8px 0;
            margin-top: 5px;
            min-width: 150px;
            z-index: 100;
            display: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .user-dropdown.show {
            display: block;
        }
        
        .dropdown-item {
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .dropdown-item:hover {
            background: rgba(29, 185, 84, 0.2);
        }
        
        h1 {
            font-size: 1.8rem;
            color: #1DB954;
            text-shadow: 0 0 10px rgba(29, 185, 84, 0.5);
            letter-spacing: 2px;
            margin-bottom: 5px;
        }
        
        .theme-switcher {
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .theme-switcher:hover {
            background: rgba(29, 185, 84, 0.3);
            transform: scale(1.05);
        }

        .feedback-btn, .support-btn, .download-app-btn {
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            text-decoration: none;
        }
        
        .feedback-btn:hover, .support-btn:hover, .download-app-btn:hover {
            background: rgba(29, 185, 84, 0.3);
            transform: scale(1.05);
        }
        
        .content {
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            flex: 1;
            gap: 15px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        
        .side-panel {
            flex: 1;
            background: #191414;
            border-radius: 12px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            min-width: 180px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .left-panel {
            text-align: right;
        }
        
        .stations-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .categories-container {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .category-btn {
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #B3B3B3;
            padding: 6px 12px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .category-btn:hover {
            background: rgba(29, 185, 84, 0.2);
            color: white;
        }
        
        .category-btn.active {
            background: rgba(29, 185, 84, 0.3);
            color: #1DB954;
            border-color: #1DB954;
        }
        
        .station-list {
            list-style: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(29, 185, 84, 0.3) #191414;
            padding-right: 5px;
            margin-bottom: 10px;
        }
        
        .station-list::-webkit-scrollbar {
            width: 5px;
        }
        
        .station-list::-webkit-scrollbar-track {
            background: #191414;
        }
        
        .station-list::-webkit-scrollbar-thumb {
            background-color: rgba(29, 185, 84, 0.3);
            border-radius: 5px;
        }
        
        .station-list li {
            padding: 10px 12px;
            margin: 4px 0;
            background: rgba(40, 40, 40, 0.8);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid #1DB954;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .station-list li:hover {
            background: rgba(29, 185, 84, 0.2);
            transform: translateX(-3px);
        }
        
        .station-list li.active {
            background: rgba(29, 185, 84, 0.3);
            border-left: 3px solid #1DB954;
            box-shadow: 0 0 10px rgba(29, 185, 84, 0.3);
        }
        
        .station-list li.christmas {
            border-left: 3px solid #FF0000;
            position: relative;
            overflow: hidden;
        }
        
        .station-list li.christmas::before {
            content: "ðŸŽ„";
            position: absolute;
            left: 5px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
        }
        
        .station-list li.christmas:hover {
            background: rgba(255, 0, 0, 0.2);
        }
        
        .station-list li.christmas.active {
            background: rgba(255, 0, 0, 0.3);
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
        }

        .station-list li.christmas-garland {
            position: relative;
            overflow: visible;
        }

        .station-list li.christmas-garland::after {
            content: "";
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border-radius: 10px;
            background: linear-gradient(45deg, #ff0000, #ff8000, #ffff00, #00ff00, #0080ff, #0000ff, #8000ff);
            background-size: 400% 400%;
            animation: garland 3s linear infinite;
            z-index: -1;
            opacity: 0.7;
        }

        @keyframes garland {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .station-likes {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
            color: #B3B3B3;
        }
        
        .station-likes .likes-count {
            min-width: 20px;
            text-align: center;
        }
        
        .station-icon {
            margin-right: 10px;
            font-size: 1rem;
            width: 20px;
            text-align: center;
        }
        
        .random-station-btn {
            background: rgba(29, 185, 84, 0.2);
            border: 1px solid rgba(29, 185, 84, 0.5);
            color: #1DB954;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            margin-top: 5px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            height: 36px;
        }
        
        .random-station-btn:hover {
            background: rgba(29, 185, 84, 0.3);
            box-shadow: 0 0 10px rgba(29, 185, 84, 0.3);
            transform: translateY(-2px);
        }
        
        .gif-container {
            flex: 3;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #191414;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            transition: all 0.3s ease;
        }
        
        .gif-placeholder {
            width: 100%;
            height: 100%;
            background: url('https://i.pinimg.com/originals/7d/04/0e/7d040e94931427709008aaeda14db9c8.gif') center/cover no-repeat;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.5s ease;
        }
        
        .playback-indicator {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 12px;
            border: 2px solid rgba(29, 185, 84, 0.3);
            pointer-events: none;
            z-index: 5;
            opacity: 0;
            transition: opacity 0.5s ease;
            animation: softPulse 3s infinite ease-in-out;
        }
        
        @keyframes softPulse {
            0%, 100% {
                border-width: 2px;
                box-shadow: 0 0 5px rgba(29, 185, 84, 0.2);
                opacity: 0.5;
            }
            50% {
                border-width: 3px;
                box-shadow: 0 0 15px rgba(29, 185, 84, 0.3);
                opacity: 0.7;
            }
        }
        
        .visualization {
            position: absolute;
            bottom: 60px;
            left: 0;
            right: 0;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 2px;
            padding: 0 20px;
            z-index: 2;
        }
        
        .bar {
            width: 4px;
            background: #1DB954;
            border-radius: 2px 2px 0 0;
            transition: height 0.2s ease;
        }
        
        .now-playing {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            text-align: center;
            z-index: 2;
        }
        
        .now-playing h3 {
            font-size: 1rem;
            color: #1DB954;
            margin-bottom: 5px;
        }
        
        .now-playing p {
            font-size: 0.8rem;
            color: #B3B3B3;
        }
        
        .heart-effect {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8rem;
            color: white;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .heart-text {
            margin-top: 20px;
            font-size: 2.5rem;
            color: #1DB954;
            text-shadow: 0 0 15px rgba(29, 185, 84, 0.9);
            font-weight: bold;
            opacity: 0;
        }
        
        @keyframes heartPop {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.3);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -60%) scale(1.2);
            }
            40% {
                opacity: 1;
                transform: translate(-50%, -65%) scale(1.3);
            }
            60% {
                opacity: 1;
                transform: translate(-50%, -70%) scale(1.4);
            }
            80% {
                opacity: 1;
                transform: translate(-50%, -75%) scale(1.3);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -80%) scale(1.5);
            }
        }
        
        @keyframes textFade {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            30% {
                opacity: 1;
                transform: translateY(0);
            }
            70% {
                opacity: 1;
                transform: translateY(-5px);
            }
            100% {
                opacity: 0;
                transform: translateY(-15px);
            }
        }
        
        .player-container {
            background: #191414;
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            height: auto;
            flex-shrink: 0;
            margin-top: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .player-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .player-left {
            display: flex;
            align-items: center;
            flex: 1;
        }
        
        .player-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #1DB954 0%, #191414 100%);
            border-radius: 50%;
            margin-right: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.3rem;
            box-shadow: 0 0 10px rgba(29, 185, 84, 0.5);
            transition: transform 0.3s ease;
        }
        
        .player-icon.playing {
            animation: rotate 10s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .station-text {
            flex: 1;
        }
        
        .station-text h2 {
            font-size: 1.3rem;
            margin-bottom: 4px;
            color: #1DB954;
        }
        
        .station-text p {
            color: #B3B3B3;
            font-size: 0.9rem;
        }
        
        .player-center {
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            gap: 10px;
            position: relative;
        }
        
        .player-buttons {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            flex: 1;
            gap: 15px;
        }
        
        .btn {
            background: rgba(50, 50, 50, 0.8);
            border: none;
            color: white;
            width: 42px;
            height: 42px;
            border-radius: 50%;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }
        
        .btn:hover {
            background: rgba(29, 185, 84, 0.4);
            transform: scale(1.05);
        }
        
        .btn-play {
            background: linear-gradient(135deg, #1DB954 0%, #191414 100%);
            width: 50px;
            height: 50px;
            font-size: 1.3rem;
            box-shadow: 0 0 12px rgba(29, 185, 84, 0.6);
        }
        
        .btn-play:hover {
            box-shadow: 0 0 16px rgba(29, 185, 84, 0.8);
        }

        .btn-like-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .likes-count-bottom {
            font-size: 0.9rem;
            color: #B3B3B3;
            font-weight: bold;
            min-width: 20px;
            text-align: center;
        }
        
        .btn-like {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2px;
            background: rgba(50, 50, 50, 0.8);
            border: none;
            color: white;
            width: 42px;
            height: 42px;
            border-radius: 50%;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }
        
        .btn-like i {
            font-size: 1.3rem;
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-like.active i {
            color: white;
        }
        
        .btn-like:hover {
            background: rgba(29, 185, 84, 0.4);
            transform: scale(1.05);
        }
        
        .player-bottom {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }
        
        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 250px;
            max-width: 100%;
            padding: 10px 0;
            position: relative;
        }
        
        .volume-icon {
            font-size: 1.1rem;
            color: #1DB954;
            width: 20px;
            text-align: center;
        }
        
        .volume-slider-container {
            flex: 1;
            position: relative;
            height: 30px;
            display: flex;
            align-items: center;
        }
        
        .volume-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            background: rgba(80, 80, 80, 0.7);
            border-radius: 5px;
            outline: none;
            cursor: pointer;
            position: relative;
            z-index: 1;
            transition: background 0.2s ease;
        }
        
        .volume-slider:hover {
            background: rgba(100, 100, 100, 0.8);
        }
        
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.4);
            transition: all 0.2s ease;
        }
        
        .volume-slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 1px 5px rgba(0,0,0,0.5);
        }
        
        .volume-slider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.4);
            transition: all 0.2s ease;
        }
        
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            margin-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 10px;
            min-height: 200px;
        }
        
        .chat-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            color: #1DB954;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            max-height: none;
            margin-bottom: 10px;
            scrollbar-width: thin;
            scrollbar-color: rgba(29, 185, 84, 0.3) #191414;
            display: flex;
            flex-direction: column;
        }
        
        .chat-messages::-webkit-scrollbar {
            width: 4px;
        }
        
        .chat-messages::-webkit-scrollbar-track {
            background: #191414;
        }
        
        .chat-messages::-webkit-scrollbar-thumb {
            background-color: rgba(29, 185, 84, 0.3);
            border-radius: 2px;
        }
        
        .message {
            padding: 6px 8px;
            margin: 4px 0;
            background: rgba(40, 40, 40, 0.6);
            border-radius: 8px;
            font-size: 0.85rem;
            line-height: 1.3;
            word-wrap: break-word;
            position: relative;
            transition: all 0.2s ease;
        }
        
        .message:hover {
            background: rgba(40, 40, 40, 0.8);
        }
        
        .message-user {
            font-weight: bold;
            color: #1DB954;
            margin-right: 5px;
        }
        
        .message-time {
            font-size: 0.7rem;
            color: #888;
            margin-left: 5px;
        }
        
        .message-reactions {
            display: flex;
            gap: 5px;
            margin-top: 4px;
            flex-wrap: wrap;
        }
        
        .reaction {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 2px 6px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 3px;
        }
        
        .reaction:hover {
            background: rgba(29, 185, 84, 0.2);
            transform: scale(1.05);
        }
        
        .reaction-count {
            font-size: 0.65rem;
            color: #B3B3B3;
        }
        
        .reaction-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            opacity: 0;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: #B3B3B3;
        }
        
        .message:hover .reaction-btn {
            opacity: 1;
        }
        
        .reaction-btn:hover {
            background: rgba(29, 185, 84, 0.2);
            color: #1DB954;
        }
        
        .reaction-picker {
            position: absolute;
            top: -45px;
            left: 0;
            background: rgba(40, 40, 40, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 5px;
            display: none;
            gap: 5px;
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .reaction-picker.show {
            display: flex;
        }
        
        .reaction-emoji {
            font-size: 1rem;
            cursor: pointer;
            padding: 3px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .reaction-emoji:hover {
            background: rgba(29, 185, 84, 0.2);
            transform: scale(1.2);
        }
        
        .more-reactions-btn {
            font-size: 0.8rem;
            cursor: pointer;
            padding: 3px 6px;
            border-radius: 4px;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .more-reactions-btn:hover {
            background: rgba(29, 185, 84, 0.2);
        }
        
        .reactions-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
        }
        
        .reactions-modal-content {
            background-color: #191414;
            margin: 10% auto;
            padding: 20px;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            border: 2px solid #1DB954;
            position: relative;
        }
        
        .reactions-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 8px;
            margin-top: 15px;
            justify-items: center;
        }
        
        .reaction-emoji-large {
            font-size: 1.5rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.2s ease;
            text-align: center;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .reaction-emoji-large:hover {
            background: rgba(29, 185, 84, 0.2);
            transform: scale(1.1);
        }
        
        .chat-input-container {
            display: flex;
            gap: 8px;
            margin-top: auto;
            position: relative;
        }
        
        .chat-input {
            flex: 1;
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 10px 8px 80px;
            border-radius: 15px;
            font-size: 0.8rem;
            outline: none;
            height: 36px;
        }
        
        .chat-input:focus {
            border-color: #1DB954;
        }
        
        .emoji-btn, .gif-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
            color: #B3B3B3;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s ease;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            z-index: 2;
        }
        
        .emoji-btn {
            left: 8px;
        }
        
        .gif-btn {
            left: 40px;
        }
        
        .emoji-btn:hover, .gif-btn:hover {
            background: rgba(29, 185, 84, 0.2);
            color: #1DB954;
        }
        
        .chat-send-btn {
            background: rgba(29, 185, 84, 0.3);
            border: 1px solid #1DB954;
            color: white;
            padding: 8px 12px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chat-send-btn:hover:not(:disabled) {
            background: rgba(29, 185, 84, 0.5);
        }
        
        .chat-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .emoji-picker {
            position: absolute;
            bottom: 45px;
            left: 0;
            background: rgba(40, 40, 40, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 12px;
            width: 300px;
            z-index: 100;
            display: none;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
        }
        
        .emoji-picker.show {
            display: block;
            animation: fadeIn 0.2s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .emoji-search {
            width: 100%;
            background: rgba(60, 60, 60, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.8rem;
            outline: none;
            margin-bottom: 10px;
        }
        
        .emoji-search:focus {
            border-color: #1DB954;
        }
        
        .emoji-categories {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 5px;
        }
        
        .emoji-category {
            background: transparent;
            border: none;
            color: #B3B3B3;
            cursor: pointer;
            font-size: 1rem;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .emoji-category:hover, .emoji-category.active {
            background: rgba(29, 185, 84, 0.2);
            color: #1DB954;
        }
        
        .emoji-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 5px;
            max-height: 200px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(29, 185, 84, 0.3) #191414;
        }
        
        .emoji-grid::-webkit-scrollbar {
            width: 4px;
        }
        
        .emoji-grid::-webkit-scrollbar-track {
            background: #191414;
        }
        
        .emoji-grid::-webkit-scrollbar-thumb {
            background-color: rgba(29, 185, 84, 0.3);
            border-radius: 2px;
        }
        
        .emoji-item {
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s ease;
            text-align: center;
        }
        
        .emoji-item:hover {
            background: rgba(29, 185, 84, 0.2);
            transform: scale(1.1);
        }
        
        .gif-picker {
            position: absolute;
            bottom: 45px;
            left: 0;
            background: rgba(40, 40, 40, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px;
            width: 300px;
            height: 350px;
            display: none;
            flex-direction: column;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .gif-picker.show {
            display: flex;
        }
        
        .gif-search {
            width: 100%;
            background: rgba(60, 60, 60, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.8rem;
            outline: none;
            margin-bottom: 10px;
        }
        
        .gif-search:focus {
            border-color: #1DB954;
        }
        
        .gif-trending {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .gif-trending-btn {
            background: rgba(60, 60, 60, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #B3B3B3;
            padding: 4px 8px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.7rem;
            transition: all 0.2s ease;
        }
        
        .gif-trending-btn:hover {
            background: rgba(29, 185, 84, 0.2);
            color: white;
        }
        
        .gif-results {
            flex: 1;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(29, 185, 84, 0.3) #191414;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 5px;
        }
        
        .gif-results::-webkit-scrollbar {
            width: 4px;
        }
        
        .gif-results::-webkit-scrollbar-track {
            background: #191414;
        }
        
        .gif-results::-webkit-scrollbar-thumb {
            background-color: rgba(29, 185, 84, 0.3);
            border-radius: 2px;
        }
        
        .gif-item {
            width: 100%;
            height: 80px;
            object-fit: cover;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .gif-item:hover {
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(29, 185, 84, 0.5);
        }
        
        .category-title {
            font-size: 0.9rem;
            color: #1DB954;
            margin-top: 10px;
            margin-bottom: 5px;
            padding-bottom: 3px;
            border-bottom: 1px solid rgba(29, 185, 84, 0.3);
        }
        
        .crt-effect {
            position: relative;
            overflow: hidden;
        }
        
        .crt-effect::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0.1) 50%, rgba(0, 0, 0, 0.25) 50%);
            background-size: 100% 3px;
            z-index: 2;
            pointer-events: none;
        }
        
        .vintage-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0.1) 50%, rgba(0, 0, 0, 0.25) 50%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.1;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
        }
        
        .modal-content {
            background-color: #191414;
            margin: 10% auto;
            padding: 20px;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            border: 2px solid #1DB954;
            position: relative;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            right: 15px;
            cursor: pointer;
        }
        
        .close:hover {
            color: #1DB954;
        }
        
        .share-preview {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        
        .share-image {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            margin-right: 15px;
            background: #1DB954;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .share-info {
            flex: 1;
        }
        
        .share-info h4 {
            color: #1DB954;
            margin-bottom: 5px;
        }
        
        .share-info p {
            color: #B3B3B3;
            font-size: 0.9rem;
        }
        
        .share-buttons-simple {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        .share-option {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .share-option:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .nickname-modal-content {
            background-color: #191414;
            margin: 20% auto;
            padding: 20px;
            border-radius: 12px;
            width: 90%;
            max-width: 350px;
            border: 2px solid #1DB954;
            position: relative;
        }
        
        .nickname-input {
            width: 100%;
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9rem;
            outline: none;
            margin: 15px 0;
        }
        
        .nickname-input:focus {
            border-color: #1DB954;
        }
        
        .nickname-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .nickname-btn {
            background: rgba(29, 185, 84, 0.3);
            border: 1px solid #1DB954;
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }
        
        .nickname-btn:hover {
            background: rgba(29, 185, 84, 0.5);
        }
        
        .nickname-btn.cancel {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .nickname-btn.cancel:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #1DB954;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .notification.show {
            opacity: 1;
        }
        
        .minecraft-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: #1DB954;
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
            z-index: 10;
            border: 2px solid #1DB954;
            box-shadow: 0 0 20px rgba(29, 185, 84, 0.5);
            display: none;
        }

        .reload-animation {
            animation: spin 0.5s linear;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .reply-btn {
            position: absolute;
            right: 35px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            opacity: 0;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: #B3B3B3;
        }

        .message:hover .reply-btn {
            opacity: 1;
        }

        .reply-btn:hover {
            background: rgba(29, 185, 84, 0.2);
            color: #1DB954;
        }

        .reply-indicator {
            background: rgba(29, 185, 84, 0.1);
            border-left: 2px solid #1DB954;
            padding: 5px 8px;
            margin-bottom: 5px;
            border-radius: 4px;
            font-size: 0.7rem;
            color: #B3B3B3;
        }

        .reply-indicator strong {
            color: #1DB954;
        }

        .cancel-reply {
            background: none;
            border: none;
            color: #888;
            cursor: pointer;
            margin-left: 5px;
            font-size: 0.7rem;
        }

        .cancel-reply:hover {
            color: #1DB954;
        }

        .message a {
            color: #1DB954;
            text-decoration: underline;
            word-break: break-all;
        }

        .message a:hover {
            color: #1ed760;
        }

        .share-radio-message {
            background: rgba(29, 185, 84, 0.1);
            border-left: 3px solid #1DB954;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .share-radio-message:hover {
            background: rgba(29, 185, 84, 0.2);
            transform: translateX(3px);
        }

        .share-radio-icon {
            color: #1DB954;
            margin-right: 5px;
        }

        @keyframes gifTransition {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.3;
                transform: scale(0.95);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .gif-transition {
            animation: gifTransition 0.6s ease-in-out;
        }

        .feedback-modal-content {
            background-color: #191414;
            margin: 5% auto;
            padding: 25px;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            border: 2px solid #1DB954;
            position: relative;
            box-shadow: 0 0 30px rgba(29, 185, 84, 0.3);
        }

        .feedback-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .feedback-tab {
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }

        .feedback-tab.active {
            border-bottom: 2px solid #1DB954;
            color: #1DB954;
        }

        .feedback-tab:hover {
            color: #1DB954;
        }

        .feedback-tab-content {
            display: none;
        }

        .feedback-tab-content.active {
            display: block;
        }

        .rating-stars {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 25px 0;
        }

        .star {
            width: 35px;
            height: 35px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="gray" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>');
            background-size: contain;
            cursor: pointer;
            transition: all 0.2s ease;
            image-rendering: pixelated;
        }

        .star.active {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%231DB954" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>');
            transform: scale(1.1);
        }

        .star:hover {
            transform: scale(1.2);
        }

        .feedback-textarea {
            width: 100%;
            height: 120px;
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 12px;
            color: white;
            font-size: 0.9rem;
            resize: none;
            margin-bottom: 20px;
            outline: none;
            transition: all 0.3s ease;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: pre-wrap;
        }

        .feedback-textarea:focus {
            border-color: #1DB954;
            box-shadow: 0 0 5px rgba(29, 185, 84, 0.3);
        }

        .submit-feedback {
            background: rgba(29, 185, 84, 0.8);
            border: none;
            border-radius: 20px;
            padding: 12px 30px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: block;
            margin: 0 auto;
            font-weight: bold;
        }

        .submit-feedback:hover {
            background: rgba(29, 185, 84, 1);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(29, 185, 84, 0.5);
        }

        .reviews-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .review-item {
            background: rgba(40, 40, 40, 0.6);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 3px solid #1DB954;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .review-user {
            font-weight: bold;
            color: #1DB954;
        }

        .review-rating {
            display: flex;
            gap: 3px;
        }

        .review-star {
            width: 16px;
            height: 16px;
            background-size: contain;
            image-rendering: pixelated;
        }

        .review-star.filled {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%231DB954" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>');
        }

        .review-star.empty {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="gray" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>');
        }

        .review-text {
            font-size: 0.9rem;
            line-height: 1.4;
            color: #e0e0e0;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .no-reviews {
            text-align: center;
            color: #888;
            font-style: italic;
            margin: 40px 0;
            font-size: 1rem;
        }

        .average-rating {
            text-align: center;
            margin: 15px 0;
            color: #1DB954;
            font-size: 1.1rem;
        }

        .mentions-list {
            position: absolute;
            bottom: 100%;
            left: 0;
            right: 0;
            background: rgba(40, 40, 40, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            max-height: 150px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .mentions-list.show {
            display: block;
        }
        
        .mention-item {
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .mention-item:hover {
            background: rgba(29, 185, 84, 0.2);
        }
        
        .mention-item.active {
            background: rgba(29, 185, 84, 0.3);
        }
        
        .user-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #1DB954;
        }
        
        .user-status.offline {
            background: #B3B3B3;
        }

        .volume-display {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
            z-index: 10;
            border: 2px solid #1DB954;
            box-shadow: 0 0 20px rgba(29, 185, 84, 0.5);
            display: none;
            font-size: 1.2rem;
            font-weight: bold;
            transition: opacity 0.3s ease;
        }

        .volume-display.show {
            display: block;
            opacity: 1;
        }

        .support-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .support-option {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: white;
        }

        .support-option:hover {
            background: rgba(29, 185, 84, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(29, 185, 84, 0.2);
        }

        .support-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(29, 185, 84, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #1DB954;
        }

        .support-info {
            flex: 1;
        }

        .support-info h4 {
            color: #1DB954;
            margin-bottom: 5px;
        }

        .support-info p {
            font-size: 0.8rem;
            color: #B3B3B3;
        }

        .card-info {
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            margin-top: 10px;
            font-family: monospace;
            text-align: center;
            font-size: 0.9rem;
            color: #1DB954;
        }

        @media (max-width: 900px) {
            .content {
                flex-direction: column;
            }
            
            .side-panel {
                width: 100%;
                height: 200px;
                margin-bottom: 12px;
            }
            
            .gif-container {
                width: 100%;
                height: 250px;
                order: -1;
            }
            
            .player-container {
                flex-direction: column;
                gap: 12px;
                padding: 12px;
            }
            
            .player-top {
                flex-direction: column;
                gap: 12px;
            }
            
            .volume-control {
                width: 100%;
                max-width: 200px;
            }
            
            .categories-container {
                overflow-x: auto;
                padding-bottom: 5px;
            }
            
            .emoji-picker, .gif-picker {
                width: 250px;
                left: -50px;
            }
            
            .header-center {
                flex: 1;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .reactions-grid {
                grid-template-columns: repeat(6, 1fr);
            }
            
            .emoji-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .feedback-modal-content {
                margin: 10% auto;
                padding: 20px;
            }

            .support-options {
                gap: 10px;
            }

            .support-option {
                padding: 12px;
            }
        }

        body.retro-theme {
            background-color: #121212;
            color: #FFFFFF;
        }
        
        body.retro-theme .vintage-overlay {
            display: block;
        }
        
        /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ PWA */
        .pwa-install-prompt {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(29, 185, 84, 0.95);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            z-index: 10000;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translate(-50%, 100px);
            }
            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }
        
        .pwa-install-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .pwa-install-icon {
            font-size: 2rem;
            color: white;
        }
        
        .pwa-install-text {
            flex: 1;
        }
        
        .pwa-install-text h4 {
            margin-bottom: 5px;
            font-size: 1rem;
        }
        
        .pwa-install-text p {
            font-size: 0.8rem;
            opacity: 0.9;
        }
        
        .pwa-install-buttons {
            display: flex;
            gap: 10px;
        }
        
        .pwa-install-btn {
            background: white;
            color: #1DB954;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .pwa-install-btn:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: scale(1.05);
        }
        
        .pwa-dismiss-btn {
            background: transparent;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .pwa-dismiss-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="retro-theme">
    <div class="vintage-overlay"></div>
    
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-gif"></div>
        <div class="loading-text">Deynik Radio</div>
    </div>
    
    <!-- ÐœÐ¾Ð´Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÐ½Ð¾ Ð´Ð»Ñ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ PWA -->
    <div class="pwa-install-prompt" id="pwaInstallPrompt" style="display: none;">
        <div class="pwa-install-content">
            <div class="pwa-install-icon">
                <i class="fas fa-download"></i>
            </div>
            <div class="pwa-install-text">
                <h4>Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Deynik Radio</h4>
                <p>Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð½Ð° Ð³Ð»Ð°Ð²Ð½Ñ‹Ð¹ ÑÐºÑ€Ð°Ð½ Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°</p>
            </div>
            <div class="pwa-install-buttons">
                <button class="pwa-install-btn" id="pwaInstallBtn">Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ</button>
                <button class="pwa-dismiss-btn" id="pwaDismissBtn">ÐŸÐ¾Ð·Ð¶Ðµ</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="shareModal">
        <div class="modal-content">
            <span class="close" id="closeShareModal">&times;</span>
            <h3>ÐŸÐ¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ Ñ€Ð°Ð´Ð¸Ð¾</h3>
            <div class="share-preview">
                <div class="share-image">
                    <i class="fas fa-radio"></i>
                </div>
                <div class="share-info">
                    <h4>Deynik Radio</h4>
                    <p>Ð¡Ð»ÑƒÑˆÐ°Ð¹Ñ‚Ðµ Ð»ÑƒÑ‡ÑˆÐ¸Ðµ Ñ€Ð°Ð´Ð¸Ð¾ÑÑ‚Ð°Ð½Ñ†Ð¸Ð¸</p>
                    <p style="font-size: 0.8rem; color: #888;">https://deyniik.github.io/DeynikRadio/</p>
                </div>
            </div>
            <div class="share-buttons-simple">
                <button class="share-option" id="copyLinkBtn">
                    <i class="fas fa-copy"></i> Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑÑ‹Ð»ÐºÑƒ
                </button>
                <button class="share-option" id="shareInChatBtn">
                    <i class="fas fa-comment"></i> ÐŸÐ¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ Ð² Ñ‡Ð°Ñ‚Ðµ
                </button>
            </div>
        </div>
    </div>
    
    <div class="reactions-modal" id="reactionsModal">
        <div class="reactions-modal-content">
            <span class="close" id="closeReactionsModal">&times;</span>
            <h3>Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ€ÐµÐ°ÐºÑ†Ð¸ÑŽ</h3>
            <div class="reactions-grid" id="reactionsGrid"></div>
        </div>
    </div>
    
    <div class="modal" id="nicknameModal">
        <div class="nickname-modal-content">
            <span class="close" id="closeNicknameModal">&times;</span>
            <h3>Ð¡Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð½Ð¸ÐºÐ½ÐµÐ¹Ð¼</h3>
            <input type="text" class="nickname-input" id="nickname-input" placeholder="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð¾Ð²Ñ‹Ð¹ Ð½Ð¸ÐºÐ½ÐµÐ¹Ð¼" maxlength="20">
            <div class="nickname-buttons">
                <button class="nickname-btn cancel" id="cancelNicknameBtn">ÐžÑ‚Ð¼ÐµÐ½Ð°</button>
                <button class="nickname-btn" id="saveNicknameBtn">Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ</button>
            </div>
        </div>
    </div>

    <div class="modal" id="feedbackModal">
        <div class="feedback-modal-content">
            <span class="close" id="closeFeedbackModal">&times;</span>
            <h3 style="text-align: center; margin-bottom: 20px;">ÐžÑ‚Ð·Ñ‹Ð²Ñ‹ Ð¾ Deynik Radio</h3>
            
            <div class="feedback-tabs">
                <div class="feedback-tab active" data-tab="write-feedback">ÐžÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ð·Ñ‹Ð²</div>
                <div class="feedback-tab" data-tab="view-feedback">ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ð¾Ñ‚Ð·Ñ‹Ð²Ñ‹</div>
            </div>
            
            <div class="feedback-tab-content active" id="write-feedback">
                <div class="rating-stars" id="ratingStars">
                    <div class="star" data-rating="1"></div>
                    <div class="star" data-rating="2"></div>
                    <div class="star" data-rating="3"></div>
                    <div class="star" data-rating="4"></div>
                    <div class="star" data-rating="5"></div>
                </div>
                <textarea class="feedback-textarea" id="feedbackText" placeholder="Ð Ð°ÑÑÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ð¾ Ð²Ð°ÑˆÐµÐ¼ Ð¾Ð¿Ñ‹Ñ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ€Ð°Ð´Ð¸Ð¾..." maxlength="500"></textarea>
                <button class="submit-feedback" id="submitFeedbackBtn">ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ð·Ñ‹Ð²</button>
            </div>
            
            <div class="feedback-tab-content" id="view-feedback">
                <div class="average-rating" id="averageRating">
                    Ð¡Ñ€ÐµÐ´Ð½ÑÑ Ð¾Ñ†ÐµÐ½ÐºÐ°: <span id="averageRatingValue">0</span>/5
                </div>
                <div class="reviews-list" id="reviewsList">
                    <div class="no-reviews">ÐŸÐ¾ÐºÐ° Ð½ÐµÑ‚ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð². Ð‘ÑƒÐ´ÑŒÑ‚Ðµ Ð¿ÐµÑ€Ð²Ñ‹Ð¼!</div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="supportModal">
        <div class="modal-content">
            <span class="close" id="closeSupportModal">&times;</span>
            <h3 style="text-align: center;">ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚</h3>
            <p style="margin: 15px 0; text-align: center;">Ð•ÑÐ»Ð¸ Ð²Ð°Ð¼ Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ Ð½Ð°ÑˆÐµ Ñ€Ð°Ð´Ð¸Ð¾, Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ ÐµÐ³Ð¾ Ñ€Ð°Ð·Ð²Ð¸Ñ‚Ð¸Ðµ:</p>
            
            <div class="support-options">
                <a href="https://www.donationalerts.com/r/deynikk" target="_blank" class="support-option">
                    <div class="support-icon">
                        <i class="fas fa-donate"></i>
                    </div>
                    <div class="support-info">
                        <h4>Donation Alerts</h4>
                        <p>Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ðµ Ð¸ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ðµ Ð¿Ð¾Ð¶ÐµÑ€Ñ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ñ</p>
                    </div>
                    <i class="fas fa-external-link-alt" style="color: #B3B3B3;"></i>
                </a>
                
                <a href="https://dalink.to/deynikk" target="_blank" class="support-option">
                    <div class="support-icon">
                        <i class="fas fa-link"></i>
                    </div>
                    <div class="support-info">
                        <h4>Dalink</h4>
                        <p>ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð± Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸</p>
                    </div>
                    <i class="fas fa-external-link-alt" style="color: #B3B3B3;"></i>
                </a>
                
                <div class="support-option" style="cursor: default;">
                    <div class="support-icon">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <div class="support-info">
                        <h4>Ð‘Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ°Ñ ÐºÐ°Ñ€Ñ‚Ð° (ÐÐ»ÑŒÑ„Ð° Ð‘Ð°Ð½Ðº)</h4>
                        <p>ÐŸÑ€ÑÐ¼Ð¾Ð¹ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ñƒ</p>
                        <div class="card-info">
                            4081 7810 5059 7275 0268
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="share-buttons-simple" style="margin-top: 20px;">
                <button class="share-option" id="closeSupportBtn">
                    <i class="fas fa-times"></i> Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ
                </button>
            </div>
        </div>
    </div>
    
    <div class="minecraft-loading" id="minecraftLoading">
        <h3>Minecraft Lo-Fi</h3>
        <p>Ð­Ñ‚Ð° ÑÑ‚Ð°Ð½Ñ†Ð¸Ñ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ÑÑ Ð´Ð¾Ð»ÑŒÑˆÐµ Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð³Ð¾. ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿Ð¾Ð´Ð¾Ð¶Ð´Ð¸Ñ‚Ðµ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾...</p>
    </div>
    
    <div class="volume-display" id="volumeDisplay">
        <div id="volumeDisplayText"><i class="fas fa-volume-up"></i> 70%</div>
    </div>
    
    <div class="container" id="mainContainer">
        <header>
            <div class="header-left">
                <div id="auth-section">
                    <button class="google-login-btn" id="googleLoginBtn">
                        <i class="fab fa-google"></i> Ð’Ð¾Ð¹Ñ‚Ð¸ Ñ‡ÐµÑ€ÐµÐ· Google
                    </button>
                </div>
                <div class="lite-switch">
                    <span class="lite-switch-label">Lite</span>
                    <label class="switch">
                        <input type="checkbox" id="liteToggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div class="header-center">
                <h1>Deynik Radio</h1>
            </div>
            <div class="header-right">
                <button class="feedback-btn" id="feedbackBtn">
                    <i class="fas fa-star"></i> ÐžÑ‚Ð·Ñ‹Ð²
                </button>
                
                <button class="support-btn" id="supportBtn">
                    <i class="fas fa-heart"></i> ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ
                </button>
                
                <!-- Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð° ÐºÐ½Ð¾Ð¿ÐºÐ°: Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ Ð¾ÐºÐ½Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ PWA -->
                <button class="download-app-btn" id="downloadAppBtn">
                    <i class="fas fa-download"></i> Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
                </button>
            </div>
        </header>
        
        <div class="content">
            <div class="side-panel left-panel crt-effect">
                <div class="stations-header">
                    <h2>Ð Ð°Ð´Ð¸Ð¾ÑÑ‚Ð°Ð½Ñ†Ð¸Ð¸</h2>
                    <span class="station-count">12</span>
                </div>
                
                <div class="categories-container">
                    <button class="category-btn active" data-category="all">Ð’ÑÐµ</button>
                    <button class="category-btn" data-category="lofi">Lo-Fi</button>
                    <button class="category-btn" data-category="thematic">Ð¢ÐµÐ¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ</button>
                    <button class="category-btn" data-category="no-copyright">Ð‘ÐµÐ· ÐÐŸ</button>
                    <button class="category-btn" data-category="top">Ð›ÑƒÑ‡ÑˆÐ¸Ðµ</button>
                </div>
                
                <ul class="station-list" id="station-list"></ul>
                
                <div class="random-station-btn" id="random-station-btn">
                    <i class="fas fa-random"></i> Ð¡Ð»ÑƒÑ‡Ð°Ð¹Ð½Ð¾Ðµ Ñ€Ð°Ð´Ð¸Ð¾
                </div>
            </div>
            
            <div class="gif-container crt-effect">
                <div class="gif-placeholder" id="mainGif"></div>
                <div class="playback-indicator" id="playback-indicator"></div>
                <div class="visualization" id="visualization">
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                </div>
                <div class="now-playing">
                    <h3>Ð¡ÐµÐ¹Ñ‡Ð°Ñ Ð¸Ð³Ñ€Ð°ÐµÑ‚: <span id="current-track">"Coffee Break"</span></h3>
                    <p>Ð˜ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒ: <span id="current-artist">Beatsmith</span></p>
                </div>
            </div>
            
            <div class="side-panel crt-effect">
                <h2>Ð¡ÐµÐ¹Ñ‡Ð°Ñ Ð¸Ð³Ñ€Ð°ÐµÑ‚</h2>
                <div style="margin: 15px 0;">
                    <h3 id="current-station">KISS FM</h3>
                    <p>Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ñ‚Ñ€ÐµÐº: <span style="color: #1DB954;" id="current-track-info">"Coffee Break"</span></p>
                    <p>Ð˜ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒ: <span style="color: #1DB954;" id="current-artist-info">Beatsmith</span></p>
                </div>
                
                <div style="margin-top: 20px;">
                    <h3>ÐšÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾</h3>
                    <p id="quality">128 kbps</p>
                </div>
                
                <div class="chat-container">
                    <div class="chat-header">
                        <i class="fas fa-comments"></i>
                        <h3>Ð§Ð°Ñ‚</h3>
                    </div>
                    <div class="chat-messages" id="chat-messages">
                        <div class="message">
                            <span class="message-user">Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð°:</span>
                            Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² Ñ‡Ð°Ñ‚ Deynik Radio!
                            <span class="message-time">Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‡Ñ‚Ð¾</span>
                        </div>
                    </div>
                    <div class="chat-input-container" id="chat-input-container">
                        <button class="emoji-btn" id="emoji-btn">
                            <i class="far fa-smile"></i>
                        </button>
                        <button class="gif-btn" id="gif-btn">
                            GIF
                        </button>
                        <input type="text" class="chat-input" id="chat-input" placeholder="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ..." maxlength="200">
                        <button class="chat-send-btn" id="chat-send-btn" disabled>
                            <i class="fas fa-paper-plane"></i>
                        </button>
                        
                        <div class="mentions-list" id="mentionsList"></div>
                        
                        <div class="emoji-picker" id="emoji-picker">
                            <input type="text" class="emoji-search" id="emoji-search" placeholder="ÐŸÐ¾Ð¸ÑÐº ÑÐ¼Ð¾Ð´Ð·Ð¸...">
                            <div class="emoji-categories">
                                <button class="emoji-category active" data-category="all">Ð’ÑÐµ</button>
                                <button class="emoji-category" data-category="smileys">ðŸ˜€</button>
                                <button class="emoji-category" data-category="hearts">â¤ï¸</button>
                                <button class="emoji-category" data-category="objects">ðŸ””</button>
                            </div>
                            <div class="emoji-grid" id="emoji-grid"></div>
                        </div>
                        
                        <div class="gif-picker" id="gif-picker">
                            <input type="text" class="gif-search" id="gif-search" placeholder="ÐŸÐ¾Ð¸ÑÐº GIF...">
                            <div class="gif-trending">
                                <button class="gif-trending-btn" data-term="funny">Ð¡Ð¼ÐµÑˆÐ½Ñ‹Ðµ</button>
                                <button class="gif-trending-btn" data-term="music">ÐœÑƒÐ·Ñ‹ÐºÐ°</button>
                                <button class="gif-trending-btn" data-term="dance">Ð¢Ð°Ð½Ñ†Ñ‹</button>
                                <button class="gif-trending-btn" data-term="love">Ð›ÑŽÐ±Ð¾Ð²ÑŒ</button>
                            </div>
                            <div class="gif-results" id="gif-results"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="player-container crt-effect">
            <div class="player-top">
                <div class="player-left">
                    <div class="player-icon" id="player-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="station-text">
                        <h2 id="player-station">KISS FM</h2>
                        <p id="player-description">Ð›ÑƒÑ‡ÑˆÐ¸Ðµ Ð¼Ð¸Ñ€Ð¾Ð²Ñ‹Ðµ Ñ…Ð¸Ñ‚Ñ‹ Ð² Ð¾Ñ‚Ð»Ð¸Ñ‡Ð½Ð¾Ð¼ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ</p>
                    </div>
                </div>
                
                <div class="player-center">
                    <button class="btn" id="prev-btn"><i class="fas fa-step-backward"></i></button>
                    <button class="btn btn-play" id="play-btn"><i class="fas fa-play"></i></button>
                    <button class="btn" id="next-btn"><i class="fas fa-step-forward"></i></button>
                </div>
                
                <div class="player-buttons">
                    <div class="btn-like-container">
                        <span class="likes-count-bottom" id="likes-count-bottom">0</span>
                        <button class="btn-like" id="like-btn" title="Ð›Ð°Ð¹ÐºÐ½ÑƒÑ‚ÑŒ ÑÑ‚Ð°Ð½Ñ†Ð¸ÑŽ">
                            <i class="far fa-heart"></i>
                        </button>
                    </div>
                    <button class="btn" id="refresh-btn" title="ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¿Ð¾Ñ‚Ð¾Ðº">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button class="btn" id="share-btn" title="ÐŸÐ¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ">
                        <i class="fas fa-share-alt"></i>
                    </button>
                </div>
            </div>
            
            <div class="player-bottom">
                <div class="volume-control">
                    <span class="volume-icon"><i class="fas fa-volume-down"></i></span>
                    <div class="volume-slider-container">
                        <input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="70" step="0.1">
                    </div>
                    <span class="volume-icon"><i class="fas fa-volume-up"></i></span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="heart-effect" id="heartEffect">
        <i class="fas fa-heart"></i>
        <div class="heart-text">ÐÑ€Ð°Ð²Ð¸Ñ‚ÑÑ!</div>
    </div>

    <div class="notification" id="notification">Ð¢ÐµÐºÑÑ‚ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ</div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBk4nxZ1ldNQUCxsbgaeYTkm9stq0o9o2Q",
            authDomain: "deygram-e4814.firebaseapp.com",
            projectId: "deygram-e4814",
            storageBucket: "deygram-e4814.firebasestorage.app",
            messagingSenderId: "591207353726",
            appId: "1:591207353726:web:d20f5e648d3daf86fcb72f"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        const radioStations = {
            kissint: {
                name: "KISS FM",
                url: "https://cloud.revma.ihrhls.com/zc185?rj-org=n3bb-e2&rj-ttl=5&rj-tok=AAABmoBxYDMAAxQEnNjentV4ug",
                description: "Ð›ÑƒÑ‡ÑˆÐ¸Ðµ Ð¼Ð¸Ñ€Ð¾Ð²Ñ‹Ðµ Ñ…Ð¸Ñ‚Ñ‹ Ð² Ð¾Ñ‚Ð»Ð¸Ñ‡Ð½Ð¾Ð¼ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ",
                currentTrack: "ÐŸÐ¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ Ñ…Ð¸Ñ‚Ñ‹",
                currentArtist: "KISS FM",
                quality: "128kbps",
                icon: "fas fa-heart",
                category: "international"
            },
            gaga: {
                name: "Lady Gaga Radio",
                url: "https://2.mystreaming.net/er/ladygagahits/icecast.audio",
                description: "Ð’ÑÐµÐ¼ Ð¼Ð¾Ð»Ñ‡Ð°Ñ‚ÑŒ! Ð˜Ð³Ñ€Ð°ÐµÑ‚ Ð¼Ð°Ñ‚ÑŒ!",
                currentTrack: "Lady Gaga Hits",
                currentArtist: "Lady Gaga",
                quality: "128kbps",
                icon: "fas fa-paw",
                category: "international"
            },
            rp: {
                name: "Radio Paradise",
                url: "https://stream.radioparadise.com/flac",
                description: "ÐÑƒÐ´Ð¸Ð¾Ñ„Ð¸Ð»ÑŒÑÐºÐ¸Ð¹ Ð¼Ð¸ÐºÑ Ñ€Ð¾ÐºÐ° Ð¸ ÑÐ»ÐµÐºÑ‚Ñ€Ð¾Ð½Ð¸ÐºÐ¸ Ð±ÐµÐ· Ð°Ð²Ñ‚Ð¾Ñ€ÑÐºÐ¸Ñ… Ð¿Ñ€Ð°Ð²",
                currentTrack: "Eclectic Mix",
                currentArtist: "Radio Paradise",
                quality: "FLAC 900+kbps",
                icon: "fas fa-music",
                category: "no-copyright"
            },
            lofi: {
                name: "LoFi Girl",
                url: "https://play.streamafrica.net/lofiradio",
                description: "Ð›ÐµÐ³ÐµÐ½Ð´Ð°Ñ€Ð½Ñ‹Ð¹ Ð»Ð¾Ñƒ-Ñ„Ð°Ð¹ ÑÑ‚Ñ€Ð¸Ð¼ Ð±ÐµÐ· Ð°Ð²Ñ‚Ð¾Ñ€ÑÐºÐ¸Ñ… Ð¿Ñ€Ð°Ð²",
                currentTrack: "Chill Beats",
                currentArtist: "LoFi Artist",
                quality: "192kbps",
                icon: "fas fa-moon",
                category: "lofi"
            },
            z100: {
                name: "Z100 New York",
                url: "https://stream.revma.ihrhls.com/zc1477",
                description: "ÐŸÐ¾Ð¿-Ñ…Ð¸Ñ‚Ñ‹ Ð¾Ñ‚ iHeartRadio",
                currentTrack: "Top 40 Hit",
                currentArtist: "Popular Artist",
                quality: "128kbps",
                icon: "fas fa-broadcast-tower",
                category: "international"
            },
            jazz: {
                name: "Jazz24",
                url: "https://knkx-live-a.edge.audiocdn.com/6285_128k?aw_0_1st.playerid=jazz24.org&uuid=s9a9vs32",
                description: "Ð›ÑƒÑ‡ÑˆÐ¸Ðµ Ð´Ð¶Ð°Ð·Ð¾Ð²Ñ‹Ðµ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸",
                currentTrack: "Smooth Jazz",
                currentArtist: "Jazz Master",
                quality: "192kbps",
                icon: "fas fa-music",
                category: "international"
            },
            chillhop: {
                name: "Chillhop Radio",
                url: "https://stream-178.zeno.fm/f3wvbbqmdg8uv?zt=eyJhbGciOiJIUzI1NiJ9.eyJzdHJlYW0iOiJmM3d2YmJxbWRnOHV2IiwiaG9zdCI6InS0cmVhbS0xNzguemVuby.Ñ„Ð¼",
                description: "Ð Ð°ÑÑÐ»Ð°Ð±Ð»ÑÑŽÑ‰Ð¸Ðµ Ð±Ð¸Ñ‚Ñ‹ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¸ Ð¾Ñ‚Ð´Ñ‹Ñ…Ð° Ð±ÐµÐ· Ð°Ð²Ñ‚Ð¾Ñ€ÑÐºÐ¸Ñ… Ð¿Ñ€Ð°Ð²",
                currentTrack: "Chill Beats",
                currentArtist: "Chillhop Music",
                quality: "128kbps",
                icon: "fas fa-moon",
                category: "lofi"
            },
            lofihiphop: {
                name: "LoFi Hip Hop",
                url: "https://stream-158.zeno.fm/0r0xa792kwzuv",
                description: "Ð›ÑƒÑ‡ÑˆÐ¸Ðµ Ñ…Ð¸Ð¿-Ñ…Ð¾Ð¿ Ð±Ð¸Ñ‚Ñ‹ Ð±ÐµÐ· Ð°Ð²Ñ‚Ð¾Ñ€ÑÐºÐ¸Ñ… Ð¿Ñ€Ð°Ð²",
                currentTrack: "Hip Hop Beats",
                currentArtist: "LoFi Artist",
                quality: "128kbps",
                icon: "fas fa-headphones",
                category: "lofi"
            },
            minecraft: {
                name: "MINECRAFT Lo Fi",
                url: "https://stream-173.zeno.fm/kp41ftw3zehvv?zt=eyJhbGciOiJIUzI1NiJ9.eyJzdHJlYW0iOiJrcDQxZnR3M3plaHZ2IiwiaG9zdCI6InN0cmVhbS0xNzMuemVuby5mbSIsInJ0dGwiOjUsImp0aSI6Ii1MelctMUFsUmtLeHZoaWkwUXBSZWciLCJpYXQiOjE3NTg2NDUyNDAsImV4cCI6MTc1ODY0NTMwMH0.Ef_7t2RVX9WvfCeKorGs2acDLze7Sp8n5bzo3Ix58xE",
                description: "Ð£ÑŽÑ‚Ð½Ñ‹Ðµ Minecraft ÑÐ°ÑƒÐ½Ð´Ñ‚Ñ€ÐµÐºÐ¸ Ð² Lo-Fi Ð°Ñ€Ð°Ð½Ð¶Ð¸Ñ€Ð¾Ð²ÐºÐµ",
                currentTrack: "Minecraft Ambience",
                currentArtist: "C418 Lo-Fi Remix",
                quality: "128kbps",
                icon: "fas fa-cube",
                category: "no-copyright"
            },
            halloween: {
                name: "Halloween Radio",
                url: "https://radio1.streamserver.link:8000/hrm-aac",
                description: "ÐœÑƒÐ·Ñ‹ÐºÐ° Ð´Ð»Ñ Ð¥ÑÐ»Ð»Ð¾ÑƒÐ¸Ð½Ð° Ð¸ ÑƒÐ¶Ð°ÑÑ‚Ð¸ÐºÐ¾Ð²",
                currentTrack: "Spooky Sounds",
                currentArtist: "Halloween FM",
                quality: "128kbps",
                icon: "fas fa-ghost",
                category: "thematic"
            },
            christmas: {
                name: "Christmas Radio",
                url: "https://1000christmashits.stream.laut.fm/1000christmashits",
                description: "ÐÐ¾Ð²Ð¾Ð³Ð¾Ð´Ð½Ð¸Ðµ Ð¸ Ñ€Ð¾Ð¶Ð´ÐµÑÑ‚Ð²ÐµÐ½ÑÐºÐ¸Ðµ Ñ…Ð¸Ñ‚Ñ‹",
                currentTrack: "Christmas Songs",
                currentArtist: "Various Artists",
                quality: "128kbps",
                icon: "fas fa-tree",
                category: "thematic",
                isChristmas: true
            }
        };

        const gifs = [
            'https://i.pinimg.com/originals/7d/04/0e/7d040e94931427709008aaeda14db9c8.gif',
            'https://i.pinimg.com/originals/20/c8/3d/20c83d1cb257a6c4e5f68960ef0c3046.gif',
            'https://i.pinimg.com/originals/9a/99/a1/9a99a10635e27f336c2cd6bec02b2aae.gif',
            'https://i.pinimg.com/originals/13/45/50/13455040862ac9b8e465185878838cf1.gif',
            'https://i.pinimg.com/originals/93/08/1e/93081e266f7f0b20778d2736978b2e84.gif',
            'https://i.gifer.com/YMm7.gif',
            'https://i.pinimg.com/originals/51/7d/50/517d50010dfe6e71d17548cae0f6f0dc.gif',
            'https://i.pinimg.com/originals/43/1c/e5/431ce5d15aab86f66a91ec9a07c9114f.gif',
            'https://i.pinimg.com/originals/61/af/12/61af12d5fb3c469039dbdf63d783c95d.gif',
            'https://i.pinimg.com/originals/2f/10/ce/2f10ce69b96c0611989308b0abc68e70.gif',
            'https://i.pinimg.com/originals/6a/d2/ee/6ad2ee191d434a996766b500a1eb197e.gif',
            'https://markiled.github.io/Images/Art/Commissions/Commission-2020-Mar-Raul.gif',
            'https://i.pinimg.com/originals/6e/fb/de/6efbde2becc91166553e90ca975aaf07.gif',
            'https://i.pinimg.com/originals/dc/9c/38/dc9c38d59ade3c7e307f64d52b3eba32.gif',
            'https://i.pinimg.com/originals/0e/85/86/0e8586ecd90850bf236dd7efdf5fa594.gif',
            'https://steamuserimages-a.akamaihd.net/ugc/9667873298027977/D91C419D674235E03A5ED1DD814E2C7B2A3AFEB5/?imw=512&amp;imh=288&amp;ima=fit&amp;impolicy=Letterbox&amp;imcolor=%23000000&amp;letterbox=true',
            'https://i.pinimg.com/originals/36/e2/3a/36e23aa11a22646e9c5f611d3b7c56f7.gif',
            'https://i.pinimg.com/originals/e4/c3/9a/e4c39a73c1d9f9d32ca69f9ea0783c66.gif',
            'https://i.pinimg.com/originals/0b/49/e3/0b49e3c7cdf6f64da625dd7b2ed94312.gif',
            'https://i.pinimg.com/originals/5d/1b/b3/5d1bb3546868cf3791880fa5720da7a2.gif',
            'https://i.pinimg.com/originals/c4/67/13/c4671376fad5ff9cc8a83c3f2174fd73.gif',
            'https://media1.tenor.com/m/znpkuJKdqGkAAAAd/the-simpsons-lisa-simpson.gif',
            'https://i.pinimg.com/originals/22/1e/a5/221ea5d2720d805681eea3b689160671.gif',
            'https://media1.tenor.com/m/joAGLtB1n8IAAAAd/the-simpsons-bart.gif',
            'https://i.gifer.com/KGXA.gif',
            'https://avatars.dzeninfra.ru/get-zen_doc/2907131/pub_5f6762b8b142594c536fda3a_5f6770b4c833846a1ddf46ac/orig',
            'https://i.pinimg.com/originals/c2/5c/ae/c25cae326dcdc03ce3ced251d45a34b6.gif',
            'https://i.pinimg.com/originals/e4/25/d3/e425d3861a7d09173b6f31faefd4460a.gif',
            'https://i.pinimg.com/originals/74/1b/06/741b066eff82e56aaab12962512ba741.gif'
        ];

        const minecraftGifs = [
            'https://i.pinimg.com/originals/44/f2/f6/44f2f6325aa9bf8c93ed6c3d6e8f8d57.gif',
            'https://i.pinimg.com/originals/05/cf/1b/05cf1b97379bb751d2bf03b55ee16c5e.gif',
            'https://i.pinimg.com/originals/da/85/43/da8543494a3baaec4fc61c2b952f8de0.gif',
            'https://i.pinimg.com/originals/d9/04/03/d9040300483e5e5465e56ddb713eeb1b.gif',
            'https://i.pinimg.com/originals/ac/25/3e/ac253eae753d0442a50f061051956cef.gif',
            'https://i.pinimg.com/originals/2a/af/bf/2aafbff9c75012c41c2c9abd92d5de35.gif',
            'https://i.pinimg.com/originals/a3/b4/55/a3b4558c0f0963b7a6135cc4a63b0d15.gif',
            'https://i.pinimg.com/originals/8a/34/3e/8a343ea387b21d843715d0a3a86059ed.gif'
        ];

        const stationIds = Object.keys(radioStations);
        
        const emojiCategories = {
            all: ["ðŸ˜€", "ðŸ˜ƒ", "ðŸ˜„", "ðŸ˜", "ðŸ˜†", "ðŸ˜…", "ðŸ˜‚", "ðŸ¤£", "ðŸ˜Š", "ðŸ˜‡", "ðŸ™‚", "ðŸ™ƒ", "ðŸ˜‰", "ðŸ˜Œ", "ðŸ˜", "ðŸ¥°", "ðŸ˜˜", "ðŸ˜—", "ðŸ˜™", "ðŸ˜š", "ðŸ˜‹", "ðŸ˜›", "ðŸ˜", "ðŸ˜œ", "ðŸ¤ª", "ðŸ¤¨", "ðŸ§", "ðŸ¤“", "ðŸ˜Ž", "ðŸ¤©", "ðŸ¥³", "ðŸ˜", "ðŸ˜’", "ðŸ˜ž", "ðŸ˜”", "ðŸ˜Ÿ", "ðŸ˜•", "ðŸ™", "â˜¹ï¸", "ðŸ˜£", "ðŸ˜–", "ðŸ˜«", "ðŸ˜©", "ðŸ¥º", "ðŸ˜¢", "ðŸ˜­", "ðŸ˜¤", "ðŸ˜ ", "ðŸ˜¡", "ðŸ¤¬", "ðŸ¤¯", "ðŸ˜³", "ðŸ¥µ", "ðŸ¥¶", "ðŸ˜±", "ðŸ˜¨", "ðŸ˜°", "ðŸ˜¥", "ðŸ˜“", "ðŸ¤—", "ðŸ¤”", "ðŸ¤­", "ðŸ¤«", "ðŸ¤¥", "ðŸ˜¶", "ðŸ˜", "ðŸ˜‘", "ðŸ˜¬", "ðŸ™„", "ðŸ˜¯", "ðŸ˜¦", "ðŸ˜§", "ðŸ˜®", "ðŸ˜²", "ðŸ¥±", "ðŸ˜´", "ðŸ¤¤", "ðŸ˜ª", "ðŸ˜µ", "ðŸ¤", "ðŸ¥´", "ðŸ¤¢", "ðŸ¤®", "ðŸ¤§", "ðŸ˜·", "ðŸ¤’", "ðŸ¤•", "ðŸ¤‘", "ðŸ¤ ", "ðŸ˜ˆ", "ðŸ‘¿", "ðŸ‘¹", "ðŸ‘º", "ðŸ¤¡", "ðŸ’©", "ðŸ‘»", "ðŸ’€", "â˜ ï¸", "ðŸ‘½", "ðŸ‘¾", "ðŸ¤–", "ðŸŽƒ"],
            smileys: ["ðŸ˜€", "ðŸ˜ƒ", "ðŸ˜„", "ðŸ˜", "ðŸ˜†", "ðŸ˜…", "ðŸ˜‚", "ðŸ¤£", "ðŸ˜Š", "ðŸ˜‡", "ðŸ™‚", "ðŸ™ƒ", "ðŸ˜‰", "ðŸ˜Œ", "ðŸ˜", "ðŸ¥°", "ðŸ˜˜", "ðŸ˜—", "ðŸ˜™", "ðŸ˜š", "ðŸ˜‹", "ðŸ˜›", "ðŸ˜", "ðŸ˜œ", "ðŸ¤ª", "ðŸ¤¨", "ðŸ§", "ðŸ¤“", "ðŸ˜Ž", "ðŸ¤©", "ðŸ¥³", "ðŸ˜", "ðŸ˜’", "ðŸ˜ž", "ðŸ˜”", "ðŸ˜Ÿ", "ðŸ˜•", "ðŸ™", "â˜¹ï¸", "ðŸ˜£", "ðŸ˜–", "ðŸ˜«", "ðŸ˜©", "ðŸ¥º", "ðŸ˜¢", "ðŸ˜­", "ðŸ˜¤", "ðŸ˜ ", "ðŸ˜¡", "ðŸ¤¬", "ðŸ¤¯", "ðŸ˜³", "ðŸ¥µ", "ðŸ¥¶", "ðŸ˜±", "ðŸ˜¨", "ðŸ˜°", "ðŸ˜¥", "ðŸ˜“", "ðŸ¤—", "ðŸ¤”", "ðŸ¤­", "ðŸ¤«", "ðŸ¤¥", "ðŸ˜¶", "ðŸ˜", "ðŸ˜‘", "ðŸ˜¬", "ðŸ™„", "ðŸ˜¯", "ðŸ˜¦", "ðŸ˜§", "ðŸ˜®", "ðŸ˜²", "ðŸ¥±", "ðŸ˜´", "ðŸ¤¤", "ðŸ˜ª", "ðŸ˜µ", "ðŸ¤", "ðŸ¥´", "ðŸ¤¢", "ðŸ¤®", "ðŸ¤§", "ðŸ˜·", "ðŸ¤’", "ðŸ¤•", "ðŸ¤‘", "ðŸ¤ ", "ðŸ˜ˆ", "ðŸ‘¿", "ðŸ‘¹", "ðŸ‘º", "ðŸ¤¡", "ðŸ’©", "ðŸ‘»", "ðŸ’€", "â˜ ï¸", "ðŸ‘½", "ðŸ‘¾", "ðŸ¤–", "ðŸŽƒ"],
            hearts: ["â¤ï¸", "ðŸ§¡", "ðŸ’›", "ðŸ’š", "ðŸ’™", "ðŸ’œ", "ðŸ–¤", "ðŸ¤", "ðŸ¤Ž", "ðŸ’”", "â£ï¸", "ðŸ’•", "ðŸ’ž", "ðŸ’“", "ðŸ’—", "ðŸ’–", "ðŸ’˜", "ðŸ’", "ðŸ’Ÿ"],
            objects: ["ðŸ””", "ðŸŽµ", "ðŸŽ¶", "ðŸŽ¼", "ðŸŽ§", "ðŸŽ¤", "ðŸŽ·", "ðŸŽ¸", "ðŸŽ¹", "ðŸŽº", "ðŸŽ»", "ðŸ¥", "ðŸ“»", "ðŸ“±", "ðŸ’»", "ðŸ–¥ï¸", "ðŸ–¨ï¸", "ðŸŽ¥", "ðŸ“¹", "ðŸ“¼", "ðŸ”", "ðŸ”Ž", "ðŸ’¡", "ðŸ“”", "ðŸ“’", "ðŸ“•", "ðŸ“—", "ðŸ“˜", "ðŸ“™", "ðŸ“š", "ðŸ“–", "ðŸ”–", "ðŸŽ¯", "ðŸ§©", "ðŸš€", "â­", "ðŸŒŸ", "ðŸŽ", "ðŸŽ‰", "ðŸŽŠ", "ðŸŽˆ", "ðŸŽ‚", "ðŸ°", "ðŸ§", "ðŸ¥§", "ðŸ¦", "ðŸ¨", "ðŸ©", "ðŸª", "ðŸŽ€", "ðŸŽ—ï¸", "ðŸŽŸï¸", "ðŸŽ«", "ðŸ†", "ðŸ…", "ðŸ¥‡", "ðŸ¥ˆ", "ðŸ¥‰", "âš½", "ðŸ€", "ðŸˆ", "âš¾", "ðŸ¥Ž", "ðŸŽ¾", "ðŸ", "ðŸ‰", "ðŸ¥", "ðŸŽ±", "ðŸª€", "ðŸ“", "ðŸ¸", "ðŸ’", "ðŸ‘", "ðŸ¥", "ðŸ", "ðŸŽ¿", "â›·ï¸", "ðŸ‚", "ðŸª‚", "ðŸ‹ï¸", "ðŸ¤¼", "ðŸ¤¸", "â›¹ï¸", "ðŸ¤¾", "ðŸŒï¸", "ðŸ‡", "ðŸ§˜"]
        };
        
        window.onload = function() {
            setTimeout(function() {
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('mainContainer').style.display = 'flex';
                initApp();
            }, 1000);
        };

        function initApp() {
            const playButton = document.getElementById('play-btn');
            const prevButton = document.getElementById('prev-btn');
            const nextButton = document.getElementById('next-btn');
            const refreshButton = document.getElementById('refresh-btn');
            const likeButton = document.getElementById('like-btn');
            const randomStationBtn = document.getElementById('random-station-btn');
            const volumeSlider = document.getElementById('volume-slider');
            const visualization = document.getElementById('visualization');
            const bars = visualization.querySelectorAll('.bar');
            const mainGif = document.getElementById('mainGif');
            const playbackIndicator = document.getElementById('playback-indicator');
            const shareBtn = document.getElementById('share-btn');
            const chatInput = document.getElementById('chat-input');
            const chatSendBtn = document.getElementById('chat-send-btn');
            const chatMessages = document.getElementById('chat-messages');
            const shareModal = document.getElementById('shareModal');
            const closeShareModal = document.getElementById('closeShareModal');
            const copyLinkBtn = document.getElementById('copyLinkBtn');
            const shareInChatBtn = document.getElementById('shareInChatBtn');
            const minecraftLoading = document.getElementById('minecraftLoading');
            const notification = document.getElementById('notification');
            const emojiBtn = document.getElementById('emoji-btn');
            const gifBtn = document.getElementById('gif-btn');
            const emojiPicker = document.getElementById('emoji-picker');
            const gifPicker = document.getElementById('gif-picker');
            const emojiSearch = document.getElementById('emoji-search');
            const gifSearch = document.getElementById('gif-search');
            const emojiGrid = document.getElementById('emoji-grid');
            const gifResults = document.getElementById('gif-results');
            const emojiCategoryBtns = document.querySelectorAll('.emoji-category');
            const gifTrendingBtns = document.querySelectorAll('.gif-trending-btn');
            const categoryBtns = document.querySelectorAll('.category-btn');
            const reactionsModal = document.getElementById('reactionsModal');
            const closeReactionsModal = document.getElementById('closeReactionsModal');
            const reactionsGrid = document.getElementById('reactionsGrid');
            const nicknameModal = document.getElementById('nicknameModal');
            const closeNicknameModal = document.getElementById('closeNicknameModal');
            const cancelNicknameBtn = document.getElementById('cancelNicknameBtn');
            const saveNicknameBtn = document.getElementById('saveNicknameBtn');
            const nicknameInput = document.getElementById('nickname-input');
            const heartEffect = document.getElementById('heartEffect');
            const likesCountBottom = document.getElementById('likes-count-bottom');
            const googleLoginBtn = document.getElementById('googleLoginBtn');
            const stationList = document.getElementById('station-list');
            
            const feedbackBtn = document.getElementById('feedbackBtn');
            const feedbackModal = document.getElementById('feedbackModal');
            const closeFeedbackModal = document.getElementById('closeFeedbackModal');
            const ratingStars = document.getElementById('ratingStars');
            const feedbackText = document.getElementById('feedbackText');
            const submitFeedbackBtn = document.getElementById('submitFeedbackBtn');
            const feedbackTabs = document.querySelectorAll('.feedback-tab');
            const feedbackTabContents = document.querySelectorAll('.feedback-tab-content');
            const reviewsList = document.getElementById('reviewsList');
            const averageRatingValue = document.getElementById('averageRatingValue');
            
            const supportBtn = document.getElementById('supportBtn');
            const supportModal = document.getElementById('supportModal');
            const closeSupportModal = document.getElementById('closeSupportModal');
            const closeSupportBtn = document.getElementById('closeSupportBtn');
            
            const mentionsList = document.getElementById('mentionsList');
            
            const volumeDisplay = document.getElementById('volumeDisplay');
            const volumeDisplayText = document.getElementById('volumeDisplayText');
            
            const liteToggle = document.getElementById('liteToggle');
            
            const downloadAppBtn = document.getElementById('downloadAppBtn');
            const pwaInstallPrompt = document.getElementById('pwaInstallPrompt');
            const pwaInstallBtn = document.getElementById('pwaInstallBtn');
            const pwaDismissBtn = document.getElementById('pwaDismissBtn');
            
            let isPlaying = false;
            let audio = null;
            let currentStationIndex = 0;
            let currentStation = stationIds[currentStationIndex];
            let visualizationInterval = null;
            let chatUnsubscribe = null;
            let likesUnsubscribe = null;
            let stationLikes = {};
            let userLikedStations = new Set();
            let currentMessageForReaction = null;
            let userNickname = localStorage.getItem('userNickname') || '';
            let replyingToMessage = null;
            let onlineUsers = {};
            let currentMentionIndex = -1;
            let volumeDisplayTimeout = null;
            
            let currentRating = 0;
            
            // ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð´Ð»Ñ PWA
            let deferredPrompt = null;
            let isAppInstalled = false;
            
            loadStationList();
            loadLikes();
            updateStationInfo();
            changeGif();
            initReactionsModal();
            loadEmojis();
            loadTrendingGifs();
            initFeedbackSystem();
            
            // Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ PWA
            initPWA();
            
            liteToggle.addEventListener('change', function() {
                if (this.checked) {
                    window.location.href = 'https://deyniik.github.io/DeynikRadio/lite';
                }
            });
            
            // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ"
            downloadAppBtn.addEventListener('click', function() {
                showPWAInstallPrompt();
            });
            
            // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ PWA
            pwaInstallBtn.addEventListener('click', function() {
                installPWA();
            });
            
            // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð¾Ñ‚ÐºÐ°Ð·Ð° Ð¾Ñ‚ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ PWA
            pwaDismissBtn.addEventListener('click', function() {
                hidePWAInstallPrompt();
                // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð² localStorage, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ ÑÐ½Ð¾Ð²Ð° ÑÐµÐ³Ð¾Ð´Ð½Ñ
                localStorage.setItem('pwaDismissed', new Date().toDateString());
            });
            
            function initPWA() {
                // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾ Ð»Ð¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
                if (window.matchMedia('(display-mode: standalone)').matches) {
                    isAppInstalled = true;
                    console.log('ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾ ÐºÐ°Ðº PWA');
                }
                
                // Ð¡Ð»ÑƒÑˆÐ°ÐµÐ¼ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ beforeinstallprompt
                window.addEventListener('beforeinstallprompt', (e) => {
                    // ÐŸÑ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð´ÑÐºÐ°Ð·ÐºÐ¸
                    e.preventDefault();
                    // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ Ð´Ð»Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ð¾Ð·Ð¶Ðµ
                    deferredPrompt = e;
                    console.log('PWA Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾');
                    
                    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð½Ðµ Ð¾Ñ‚ÐºÐ°Ð·Ñ‹Ð²Ð°Ð»ÑÑ Ð»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑÐµÐ³Ð¾Ð´Ð½Ñ
                    const lastDismissed = localStorage.getItem('pwaDismissed');
                    const today = new Date().toDateString();
                    
                    if (lastDismissed !== today && !isAppInstalled) {
                        // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÑƒ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸
                        setTimeout(() => {
                            showPWAInstallPrompt();
                        }, 3000);
                    }
                });
                
                // ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÐµÐ¼ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÑƒ
                window.addEventListener('appinstalled', () => {
                    isAppInstalled = true;
                    deferredPrompt = null;
                    hidePWAInstallPrompt();
                    console.log('PWA Ð±Ñ‹Ð»Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾');
                    showNotification('ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾!', 'success');
                });
                
                // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÐµÑÐ»Ð¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ ÑƒÐ¶Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾
                if (window.navigator.standalone === true) {
                    isAppInstalled = true;
                }
            }
            
            function showPWAInstallPrompt() {
                if (deferredPrompt && !isAppInstalled) {
                    pwaInstallPrompt.style.display = 'block';
                } else if (isAppInstalled) {
                    showNotification('ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ ÑƒÐ¶Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾ Ð½Ð° Ð²Ð°ÑˆÐµÐ¼ ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ðµ', 'info');
                } else {
                    showNotification('Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð° Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð°Ñ…', 'info');
                }
            }
            
            function hidePWAInstallPrompt() {
                pwaInstallPrompt.style.display = 'none';
            }
            
            function installPWA() {
                if (deferredPrompt) {
                    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð½Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ðµ Ð¾ÐºÐ½Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸
                    deferredPrompt.prompt();
                    
                    // Ð–Ð´ÐµÐ¼ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¿Ñ€Ð¸Ð½ÑÐ» Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð½Ð° ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÑƒ');
                            isAppInstalled = true;
                        } else {
                            console.log('ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¾Ñ‚ÐºÐ»Ð¾Ð½Ð¸Ð» Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð½Ð° ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÑƒ');
                            // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð¾Ñ‚ÐºÐ°Ð· Ð² localStorage
                            localStorage.setItem('pwaDismissed', new Date().toDateString());
                        }
                        deferredPrompt = null;
                        hidePWAInstallPrompt();
                    });
                }
            }
            
            function loadStationList() {
                stationList.innerHTML = '';
                
                const allStations = [
                    { id: 'kissint', category: 'international', title: 'ÐœÐµÐ¶Ð´ÑƒÐ½Ð°Ñ€Ð¾Ð´Ð½Ñ‹Ðµ' },
                    { id: 'gaga', category: 'international' },
                    { id: 'rp', category: 'no-copyright' },
                    { id: 'lofi', category: 'lofi' },
                    { id: 'z100', category: 'international' },
                    { id: 'jazz', category: 'international' },
                    { id: 'chillhop', category: 'lofi', title: 'Lo-Fi' },
                    { id: 'lofihiphop', category: 'lofi' },
                    { id: 'minecraft', category: 'lofi' },
                    { id: 'halloween', category: 'thematic', title: 'Ð¢ÐµÐ¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ' },
                    { id: 'christmas', category: 'thematic' }
                ];
                
                let lastCategory = '';
                
                allStations.forEach(station => {
                    const stationData = radioStations[station.id];
                    
                    if (station.title && station.title !== lastCategory) {
                        const categoryTitle = document.createElement('div');
                        categoryTitle.className = 'category-title';
                        categoryTitle.textContent = station.title;
                        stationList.appendChild(categoryTitle);
                        lastCategory = station.title;
                    }
                    
                    const stationItem = document.createElement('li');
                    stationItem.setAttribute('data-station', station.id);
                    
                    if (stationData.isChristmas) {
                        stationItem.className = 'christmas-garland';
                    } else {
                        stationItem.className = stationData.isChristmas ? 'christmas' : '';
                    }
                    
                    if (station.id === currentStation) {
                        stationItem.classList.add('active');
                    }
                    
                    stationItem.innerHTML = `
                        <div style="display: flex; align-items: center;">
                            <span class="station-icon"><i class="${stationData.icon}"></i></span> ${stationData.name}
                        </div>
                        <div class="station-likes">
                            <span class="likes-count">0</span> <i class="fas fa-heart"></i>
                        </div>
                    `;
                    
                    stationItem.addEventListener('click', function() {
                        const stationId = this.getAttribute('data-station');
                        currentStationIndex = stationIds.indexOf(stationId);
                        isPlaying = true;
                        playButton.innerHTML = '<i class="fas fa-pause"></i>';
                        document.getElementById('player-icon').classList.add('playing');
                        changeStation();
                    });
                    
                    stationList.appendChild(stationItem);
                });
            }
            
            function updateVolume(value) {
                if (value < 0) value = 0;
                if (value > 100) value = 100;
                
                volumeSlider.value = value;
                if (audio) {
                    audio.volume = value / 100;
                }
                updateVolumeIcon();
                
                let volumeIcon = 'fa-volume-up';
                if (value == 0) volumeIcon = 'fa-volume-mute';
                else if (value < 50) volumeIcon = 'fa-volume-down';
                
                volumeDisplayText.innerHTML = `<i class="fas ${volumeIcon}"></i> ${Math.round(value)}%`;
                
                if (volumeDisplayTimeout) {
                    clearTimeout(volumeDisplayTimeout);
                }
                
                volumeDisplay.style.display = 'block';
                volumeDisplay.style.opacity = '1';
                
                volumeDisplayTimeout = setTimeout(() => {
                    volumeDisplay.style.opacity = '0';
                    setTimeout(() => {
                        volumeDisplay.style.display = 'none';
                    }, 300);
                }, 2000);
            }
            
            document.addEventListener('keydown', function(e) {
                if (e.target !== chatInput) {
                    if (e.key === 'ArrowUp') {
                        e.preventDefault();
                        const currentVolume = parseFloat(volumeSlider.value);
                        updateVolume(currentVolume + 5);
                    } else if (e.key === 'ArrowDown') {
                        e.preventDefault();
                        const currentVolume = parseFloat(volumeSlider.value);
                        updateVolume(currentVolume - 5);
                    }
                }
            });
            
            volumeSlider.addEventListener('wheel', function(e) {
                e.preventDefault();
                const delta = e.deltaY > 0 ? -5 : 5;
                const currentVolume = parseFloat(volumeSlider.value);
                updateVolume(currentVolume + delta);
            });

            volumeSlider.addEventListener('input', function() {
                updateVolume(this.value);
            });

            function initFeedbackSystem() {
                displayReviews();
                
                const stars = ratingStars.querySelectorAll('.star');
                stars.forEach(star => {
                    star.addEventListener('click', function() {
                        const rating = parseInt(this.getAttribute('data-rating'));
                        setRating(rating);
                    });
                    
                    star.addEventListener('mouseover', function() {
                        const rating = parseInt(this.getAttribute('data-rating'));
                        highlightStars(rating);
                    });
                });
                
                ratingStars.addEventListener('mouseleave', function() {
                    highlightStars(currentRating);
                });
                
                submitFeedbackBtn.addEventListener('click', submitReview);
                
                feedbackTabs.forEach(tab => {
                    tab.addEventListener('click', function() {
                        const tabId = this.getAttribute('data-tab');
                        
                        feedbackTabs.forEach(t => t.classList.remove('active'));
                        feedbackTabContents.forEach(c => c.classList.remove('active'));
                        
                        this.classList.add('active');
                        document.getElementById(tabId).classList.add('active');
                    });
                });
            }
            
            function setRating(rating) {
                currentRating = rating;
                highlightStars(rating);
            }
            
            function highlightStars(rating) {
                const stars = ratingStars.querySelectorAll('.star');
                stars.forEach((star, index) => {
                    if (index < rating) {
                        star.classList.add('active');
                    } else {
                        star.classList.remove('active');
                    }
                });
            }
            
            function submitReview() {
                if (currentRating === 0) {
                    showNotification('ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¾Ñ†ÐµÐ½ÐºÑƒ', 'error');
                    return;
                }
                
                const reviewText = feedbackText.value.trim();
                if (reviewText === '') {
                    showNotification('ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð½Ð°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ð¾Ñ‚Ð·Ñ‹Ð²', 'error');
                    return;
                }
                
                const user = auth.currentUser;
                if (!user) {
                    showNotification('Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ð·Ñ‹Ð²', 'error');
                    return;
                }
                
                const userName = userNickname || (user.displayName || 'ÐÐ½Ð¾Ð½Ð¸Ð¼');
                const userId = user.uid;
                
                const review = {
                    id: Date.now().toString(),
                    user: userName,
                    userId: userId,
                    rating: currentRating,
                    text: reviewText,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                };
                
                db.collection('reviews').add(review)
                    .then(() => {
                        feedbackText.value = '';
                        setRating(0);
                        displayReviews();
                        feedbackTabs.forEach(t => t.classList.remove('active'));
                        feedbackTabContents.forEach(c => c.classList.remove('active'));
                        document.querySelector('[data-tab="view-feedback"]').classList.add('active');
                        document.getElementById('view-feedback').classList.add('active');
                        showNotification('Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð·Ð° Ð²Ð°Ñˆ Ð¾Ñ‚Ð·Ñ‹Ð²!', 'success');
                    })
                    .catch(error => {
                        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°:', error);
                        showNotification('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐµ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°', 'error');
                    });
            }
            
            function displayReviews() {
                reviewsList.innerHTML = '';
                
                db.collection('reviews')
                    .orderBy('timestamp', 'desc')
                    .limit(50)
                    .get()
                    .then((snapshot) => {
                        if (snapshot.empty) {
                            reviewsList.innerHTML = '<div class="no-reviews">ÐŸÐ¾ÐºÐ° Ð½ÐµÑ‚ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð². Ð‘ÑƒÐ´ÑŒÑ‚Ðµ Ð¿ÐµÑ€Ð²Ñ‹Ð¼!</div>';
                            averageRatingValue.textContent = '0';
                            return;
                        }
                        
                        let totalRating = 0;
                        let reviewCount = 0;
                        
                        snapshot.forEach(doc => {
                            const review = doc.data();
                            totalRating += review.rating;
                            reviewCount++;
                            
                            const reviewItem = document.createElement('div');
                            reviewItem.className = 'review-item';
                            
                            let starsHtml = '';
                            for (let i = 1; i <= 5; i++) {
                                if (i <= review.rating) {
                                    starsHtml += '<div class="review-star filled"></div>';
                                } else {
                                    starsHtml += '<div class="review-star empty"></div>';
                                }
                            }
                            
                            const date = review.timestamp ? review.timestamp.toDate().toLocaleDateString('ru-RU') : 'Ð½ÐµÐ´Ð°Ð²Ð½Ð¾';
                            
                            reviewItem.innerHTML = `
                                <div class="review-header">
                                    <div class="review-user">${review.user}</div>
                                    <div class="review-rating">${starsHtml}</div>
                                </div>
                                <div class="review-text">${review.text}</div>
                                <div style="font-size: 0.7rem; color: #888; margin-top: 8px;">${date}</div>
                            `;
                            
                            reviewsList.appendChild(reviewItem);
                        });
                        
                        const averageRating = reviewCount > 0 ? (totalRating / reviewCount).toFixed(1) : '0';
                        averageRatingValue.textContent = averageRating;
                    })
                    .catch(error => {
                        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²:', error);
                        reviewsList.innerHTML = '<div class="no-reviews">ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²</div>';
                        averageRatingValue.textContent = '0';
                    });
            }

            function initReactionsModal() {
                const reactions = [
                    'ðŸ˜€', 'ðŸ˜ƒ', 'ðŸ˜„', 'ðŸ˜', 'ðŸ˜†', 'ðŸ˜…', 'ðŸ˜‚', 'ðŸ¤£', 'ðŸ˜Š', 'ðŸ˜‡', 
                    'ðŸ™‚', 'ðŸ™ƒ', 'ðŸ˜‰', 'ðŸ˜Œ', 'ðŸ˜', 'ðŸ¥°', 'ðŸ˜˜', 'ðŸ˜—', 'ðŸ˜™', 'ðŸ˜š',
                    'ðŸ˜‹', 'ðŸ˜›', 'ðŸ˜', 'ðŸ˜œ', 'ðŸ¤ª', 'ðŸ¤¨', 'ðŸ§', 'ðŸ¤“', 'ðŸ˜Ž', 'ðŸ¤©',
                    'ðŸ¥³', 'ðŸ˜', 'ðŸ˜’', 'ðŸ˜ž', 'ðŸ˜”', 'ðŸ˜Ÿ', 'ðŸ˜•', 'ðŸ™', 'â˜¹ï¸', 'ðŸ˜£',
                    'ðŸ˜–', 'ðŸ˜«', 'ðŸ˜©', 'ðŸ¥º', 'ðŸ˜¢', 'ðŸ˜­', 'ðŸ˜¤', 'ðŸ˜ ', 'ðŸ˜¡', 'ðŸ¤¬',
                    'ðŸ¤¯', 'ðŸ˜³', 'ðŸ¥µ', 'ðŸ¥¶', 'ðŸ˜±', 'ðŸ˜¨', 'ðŸ˜°', 'ðŸ˜¥', 'ðŸ˜“', 'ðŸ¤—',
                    'ðŸ¤”', 'ðŸ¤­', 'ðŸ¤«', 'ðŸ¤¥', 'ðŸ˜¶', 'ðŸ˜', 'ðŸ˜‘', 'ðŸ˜¬', 'ðŸ™„', 'ðŸ˜¯',
                    'ðŸ˜¦', 'ðŸ˜§', 'ðŸ˜®', 'ðŸ˜²', 'ðŸ¥±', 'ðŸ˜´', 'ðŸ¤¤', 'ðŸ˜ª', 'ðŸ˜µ', 'ðŸ¤',
                    'ðŸ¥´', 'ðŸ¤¢', 'ðŸ¤®', 'ðŸ¤§', 'ðŸ˜·', 'ðŸ¤’', 'ðŸ¤•', 'ðŸ¤‘', 'ðŸ¤ ', 'ðŸ˜ˆ',
                    'ðŸ‘¿', 'ðŸ‘¹', 'ðŸ‘º', 'ðŸ¤¡', 'ðŸ’©', 'ðŸ‘»', 'ðŸ’€', 'â˜ ï¸', 'ðŸ‘½', 'ðŸ‘¾',
                    'ðŸ¤–', 'ðŸŽƒ', 'â¤ï¸', 'ðŸ§¡', 'ðŸ’›', 'ðŸ’š', 'ðŸ’™', 'ðŸ’œ', 'ðŸ–¤', 'ðŸ¤',
                    'ðŸ¤Ž', 'ðŸ’”', 'â£ï¸', 'ðŸ’•', 'ðŸ’ž', 'ðŸ’“', 'ðŸ’—', 'ðŸ’–', 'ðŸ’˜', 'ðŸ’',
                    'ðŸ’Ÿ', 'ðŸ‘', 'ðŸ‘Ž', 'ðŸ‘Œ', 'ðŸ¤', 'âœŒï¸', 'ðŸ¤ž', 'ðŸ¤Ÿ', 'ðŸ¤˜', 'ðŸ‘ˆ',
                    'ðŸ‘‰', 'ðŸ‘†', 'ðŸ–•', 'ðŸ‘‡', 'â˜ï¸', 'âœ‹', 'ðŸ¤š', 'ðŸ–ï¸', 'ðŸ––', 'ðŸ‘‹',
                    'ðŸ¤™', 'ðŸ’ª', 'ðŸ¦¾', 'ðŸ¦¿', 'ðŸ¦µ', 'ðŸ¦¶', 'ðŸ‘‚', 'ðŸ¦»', 'ðŸ‘ƒ', 'ðŸ§ ',
                    'ðŸ«€', 'ðŸ«', 'ðŸ¦·', 'ðŸ¦´', 'ðŸ‘€', 'ðŸ‘ï¸', 'ðŸ‘…', 'ðŸ‘„', 'ðŸ’‹', 'ðŸ©¸'
                ];
                
                reactionsGrid.innerHTML = '';
                reactions.forEach(reaction => {
                    const emojiElement = document.createElement('div');
                    emojiElement.className = 'reaction-emoji-large';
                    emojiElement.textContent = reaction;
                    emojiElement.addEventListener('click', function() {
                        if (currentMessageForReaction) {
                            addReactionToMessage(currentMessageForReaction, reaction);
                            reactionsModal.style.display = 'none';
                        }
                    });
                    reactionsGrid.appendChild(emojiElement);
                });
            }

            function loadEmojis() {
                emojiGrid.innerHTML = '';
                emojiCategories.all.forEach(emoji => {
                    const emojiElement = document.createElement('div');
                    emojiElement.className = 'emoji-item';
                    emojiElement.textContent = emoji;
                    emojiElement.addEventListener('click', function() {
                        insertEmoji(emoji);
                        emojiPicker.classList.remove('show');
                    });
                    emojiGrid.appendChild(emojiElement);
                });
            }

            function filterEmojisByCategory(category) {
                emojiGrid.innerHTML = '';
                const emojis = category === 'all' ? emojiCategories.all : emojiCategories[category];
                
                emojis.forEach(emoji => {
                    const emojiElement = document.createElement('div');
                    emojiElement.className = 'emoji-item';
                    emojiElement.textContent = emoji;
                    emojiElement.addEventListener('click', function() {
                        insertEmoji(emoji);
                        emojiPicker.classList.remove('show');
                    });
                    emojiGrid.appendChild(emojiElement);
                });
            }

            function filterEmojis() {
                const searchTerm = emojiSearch.value.toLowerCase();
                const currentCategory = document.querySelector('.emoji-category.active').dataset.category;
                const emojis = currentCategory === 'all' ? emojiCategories.all : emojiCategories[currentCategory];
                
                emojiGrid.innerHTML = '';
                
                emojis.forEach(emoji => {
                    if (searchTerm === '' || emoji.includes(searchTerm)) {
                        const emojiElement = document.createElement('div');
                        emojiElement.className = 'emoji-item';
                        emojiElement.textContent = emoji;
                        emojiElement.addEventListener('click', function() {
                            insertEmoji(emoji);
                            emojiPicker.classList.remove('show');
                        });
                        emojiGrid.appendChild(emojiElement);
                    }
                });
            }

            function insertEmoji(emoji) {
                chatInput.value += emoji;
                chatInput.focus();
            }

            function loadTrendingGifs() {
                const trendingGifs = [
                    'https://media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif',
                    'https://media.giphy.com/media/3o7aD2d7hy9ktXNDP2/giphy.gif',
                    'https://media.giphy.com/media/3o72FfM5HJydzafgUE/giphy.gif',
                    'https://media.giphy.com/media/l0MYEqEzwMWFCg8rm/giphy.gif',
                    'https://media.giphy.com/media/3o7abGQa0aRsohveX6/giphy.gif',
                    'https://media.giphy.com/media/3o7TKM1Fa6k5g2qsxq/giphy.gif'
                ];
                
                gifResults.innerHTML = '';
                trendingGifs.forEach(gifUrl => {
                    const gifElement = document.createElement('img');
                    gifElement.className = 'gif-item';
                    gifElement.src = gifUrl;
                    gifElement.addEventListener('click', function() {
                        sendGifMessage(gifUrl);
                        gifPicker.classList.remove('show');
                    });
                    gifResults.appendChild(gifElement);
                });
            }

            async function searchGifs(term = null) {
                const searchTerm = term || gifSearch.value;
                if (!searchTerm) {
                    loadTrendingGifs();
                    return;
                }
                
                const apiKey = 'LIVDSRZULELA';
                const limit = 20;
                
                try {
                    const response = await fetch(`https://g.tenor.com/v1/search?q=${encodeURIComponent(searchTerm)}&key=${apiKey}&limit=${limit}`);
                    const data = await response.json();
                    
                    gifResults.innerHTML = '';
                    
                    data.results.forEach(result => {
                        const gifUrl = result.media[0].gif.url;
                        const gifElement = document.createElement('img');
                        gifElement.className = 'gif-item';
                        gifElement.src = gifUrl;
                        gifElement.addEventListener('click', function() {
                            sendGifMessage(gifUrl);
                            gifPicker.classList.remove('show');
                        });
                        gifResults.appendChild(gifElement);
                    });
                } catch (error) {
                    console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð¸ÑÐºÐ° GIF:', error);
                    loadTrendingGifs();
                }
            }

            function sendGifMessage(gifUrl) {
                const user = auth.currentUser;
                if (!user) {
                    alert('Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ');
                    return;
                }
                
                const displayName = userNickname || (user.displayName || 'ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ');
                
                const message = {
                    gif: gifUrl,
                    userName: displayName,
                    userId: user.uid,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    reactions: {}
                };
                
                chatSendBtn.disabled = true;
                chatSendBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                
                db.collection('chat').add(message)
                    .then(() => {})
                    .finally(() => {
                        chatSendBtn.disabled = false;
                        chatSendBtn.innerHTML = '<i class="fas fa-paper-plane"></i>';
                    });
            }

            function showHeartEffect() {
                heartEffect.style.display = 'flex';
                heartEffect.style.opacity = '1';
                
                heartEffect.style.animation = 'none';
                void heartEffect.offsetWidth;
                
                heartEffect.style.animation = 'heartPop 1.5s ease-out forwards';
                
                const heartText = heartEffect.querySelector('.heart-text');
                heartText.style.animation = 'textFade 1.5s ease-out 0.3s forwards';
                
                setTimeout(() => {
                    heartEffect.style.display = 'none';
                }, 1500);
            }

            function updateVolumeIcon() {
                const volume = volumeSlider.value;
                const volumeIcons = document.querySelectorAll('.volume-icon i');
                volumeIcons.forEach(icon => {
                    if (volume == 0) volumeIcon = 'fa-volume-mute';
                    else if (volume < 50) volumeIcon = 'fa-volume-down';
                    else volumeIcon = 'fa-volume-up';
                    icon.className = `fas ${volumeIcon}`;
                });
            }
            
            updateVolumeIcon();
            
            function showNotification(message, type = 'info') {
                notification.textContent = message;
                notification.className = 'notification';
                
                if (type === 'success') {
                    notification.style.background = '#1DB954';
                } else if (type === 'error') {
                    notification.style.background = '#FF5722';
                } else {
                    notification.style.background = '#2196F3';
                }
                
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
            
            function loadLikes() {
                if (likesUnsubscribe) likesUnsubscribe();
                
                likesUnsubscribe = db.collection('stationLikes')
                    .onSnapshot((snapshot) => {
                        stationLikes = {};
                        userLikedStations = new Set();
                        
                        snapshot.forEach((doc) => {
                            const data = doc.data();
                            stationLikes[doc.id] = data;
                        });
                        
                        const user = auth.currentUser;
                        const userId = user ? user.uid : 'anonymous';
                        
                        Object.keys(stationLikes).forEach(stationId => {
                            if (stationLikes[stationId].users && stationLikes[stationId].users[userId]) {
                                userLikedStations.add(stationId);
                            }
                        });
                        
                        updateLikesUI();
                    });
            }
            
            function toggleLike() {
                const user = auth.currentUser;
                const userId = user ? user.uid : 'anonymous';
                const stationId = currentStation;
                
                if (userLikedStations.has(stationId)) {
                    removeLike(stationId, userId);
                } else {
                    addLike(stationId, userId);
                    showHeartEffect();
                }
                
                likeButton.style.transform = 'scale(1.2)';
                setTimeout(() => {
                    likeButton.style.transform = 'scale(1)';
                }, 200);
            }
            
            function addLike(stationId, userId) {
                const stationRef = db.collection('stationLikes').doc(stationId);
                
                stationRef.get().then((doc) => {
                    if (doc.exists) {
                        const data = doc.data();
                        const newCount = (data.count || 0) + 1;
                        const users = data.users || {};
                        users[userId] = true;
                        
                        stationRef.update({
                            count: newCount,
                            users: users
                        });
                    } else {
                        stationRef.set({
                            count: 1,
                            users: {
                                [userId]: true
                            }
                        });
                    }
                });
            }
            
            function removeLike(stationId, userId) {
                const stationRef = db.collection('stationLikes').doc(stationId);
                
                stationRef.get().then((doc) => {
                    if (doc.exists) {
                        const data = doc.data();
                        const newCount = Math.max(0, (data.count || 0) - 1);
                        const users = data.users || {};
                        delete users[userId];
                        
                        if (newCount === 0) {
                            stationRef.delete();
                        } else {
                            stationRef.update({
                                count: newCount,
                                users: users
                            });
                        }
                    }
                });
            }
            
            function updateLikesUI() {
                const stationItems = document.querySelectorAll('.station-list li');
                stationItems.forEach(item => {
                    const stationId = item.getAttribute('data-station');
                    const likesCount = item.querySelector('.likes-count');
                    if (likesCount) {
                        const count = stationLikes[stationId] ? stationLikes[stationId].count || 0 : 0;
                        likesCount.textContent = count;
                    }
                });
                
                const isLiked = userLikedStations.has(currentStation);
                likeButton.classList.toggle('active', isLiked);
                likeButton.querySelector('i').className = isLiked ? 'fas fa-heart' : 'far fa-heart';
                
                const currentCount = stationLikes[currentStation] ? stationLikes[currentStation].count || 0 : 0;
                likesCountBottom.textContent = currentCount;
            }
            
            function updateAuthUI(user) {
                const authSection = document.getElementById('auth-section');
                
                if (user) {
                    const displayName = userNickname || user.displayName || 'ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ';
                    const firstLetter = displayName.charAt(0).toUpperCase();
                    
                    authSection.innerHTML = `
                        <div class="user-profile" id="user-profile">
                            <div class="user-avatar">${firstLetter}</div>
                            <div class="user-name">${displayName}</div>
                            <button class="edit-nickname-btn" title="Ð¡Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð½Ð¸Ðº">
                                <i class="fas fa-pencil-alt"></i>
                            </button>
                            <div class="user-dropdown" id="user-dropdown">
                                <div class="dropdown-item" id="edit-nickname-dropdown">
                                    <i class="fas fa-user-edit"></i> Ð¡Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð½Ð¸Ðº
                                </div>
                                <div class="dropdown-item" id="sign-out-btn">
                                    <i class="fas fa-sign-out-alt"></i> Ð’Ñ‹Ð¹Ñ‚Ð¸
                                </div>
                            </div>
                        </div>
                    `;
                    
                    loadChatHistory();
                    
                    const userProfile = document.getElementById('user-profile');
                    const userDropdown = document.getElementById('user-dropdown');
                    const editNicknameDropdown = document.getElementById('edit-nickname-dropdown');
                    const signOutBtn = document.getElementById('sign-out-btn');
                    
                    userProfile.addEventListener('click', function(e) {
                        e.stopPropagation();
                        userDropdown.classList.toggle('show');
                    });
                    
                    editNicknameDropdown.addEventListener('click', function() {
                        nicknameInput.value = userNickname || user.displayName || '';
                        nicknameModal.style.display = 'block';
                        userDropdown.classList.remove('show');
                    });
                    
                    document.querySelector('.edit-nickname-btn').addEventListener('click', function(e) {
                        e.stopPropagation();
                        nicknameInput.value = userNickname || user.displayName || '';
                        nicknameModal.style.display = 'block';
                    });
                    
                    signOutBtn.addEventListener('click', function() {
                        auth.signOut();
                    });
                    
                } else {
                    authSection.innerHTML = `
                        <button class="google-login-btn" id="googleLoginBtn">
                            <i class="fab fa-google"></i> Ð’Ð¾Ð¹Ñ‚Ð¸ Ñ‡ÐµÑ€ÐµÐ· Google
                        </button>
                    `;
                    
                    loadChatHistory();
                    
                    document.getElementById('googleLoginBtn').addEventListener('click', signInWithGoogle);
                }
            }
            
            function saveNickname() {
                const newNickname = nicknameInput.value.trim();
                if (newNickname === '') {
                    showNotification('Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð¸ÐºÐ½ÐµÐ¹Ð¼', 'error');
                    return;
                }
                
                userNickname = newNickname;
                localStorage.setItem('userNickname', userNickname);
                nicknameModal.style.display = 'none';
                updateAuthUI(auth.currentUser);
                showNotification('ÐÐ¸ÐºÐ½ÐµÐ¹Ð¼ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½!', 'success');
            }
            
            function signInWithGoogle() {
                const provider = new firebase.auth.GoogleAuthProvider();
                
                provider.addScope('profile');
                provider.addScope('email');
                
                provider.setCustomParameters({
                    prompt: 'select_account'
                });
                
                auth.signInWithPopup(provider)
                    .then((result) => {
                        const user = result.user;
                        showNotification(`Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ, ${user.displayName || 'ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ'}!`, 'success');
                    })
                    .catch((error) => {
                        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ñ…Ð¾Ð´Ð°:', error);
                        
                        let errorMessage = 'ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°';
                        
                        switch(error.code) {
                            case 'auth/popup-blocked':
                                errorMessage = 'Ð’ÑÐ¿Ð»Ñ‹Ð²Ð°ÑŽÑ‰ÐµÐµ Ð¾ÐºÐ½Ð¾ Ð±Ñ‹Ð»Ð¾ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¾ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð¾Ð¼. Ð Ð°Ð·Ñ€ÐµÑˆÐ¸Ñ‚Ðµ Ð²ÑÐ¿Ð»Ñ‹Ð²Ð°ÑŽÑ‰Ð¸Ðµ Ð¾ÐºÐ½Ð° Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ ÑÐ°Ð¹Ñ‚Ð°.';
                                break;
                            case 'auth/popup-closed-by-user':
                                errorMessage = 'ÐžÐºÐ½Ð¾ Ð²Ñ…Ð¾Ð´Ð° Ð±Ñ‹Ð»Ð¾ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¾ Ð´Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸.';
                                break;
                            case 'auth/cancelled-popup-request':
                                errorMessage = 'ÐÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð±Ñ‹Ð»Ð° Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ð°.';
                                break;
                            case 'auth/unauthorized-domain':
                                errorMessage = 'Ð”Ð¾Ð¼ÐµÐ½ Ð½Ðµ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½ Ð´Ð»Ñ OAuth Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð² Firebase Console.';
                                break;
                            default:
                                errorMessage = error.message || 'ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð²Ñ…Ð¾Ð´Ðµ';
                        }
                        
                        showNotification('ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ñ…Ð¾Ð´Ð°: ' + errorMessage, 'error');
                    });
            }

            function loadChatHistory() {
                if (chatUnsubscribe) chatUnsubscribe();
                
                chatUnsubscribe = db.collection('chat')
                    .orderBy('timestamp', 'desc')
                    .limit(50)
                    .onSnapshot((snapshot) => {
                        chatMessages.innerHTML = '';
                        
                        if (snapshot.empty) {
                            chatMessages.innerHTML = '<div class="message">Ð§Ð°Ñ‚ Ð¿ÑƒÑÑ‚. Ð‘ÑƒÐ´ÑŒÑ‚Ðµ Ð¿ÐµÑ€Ð²Ñ‹Ð¼!</div>';
                            scrollChatToBottom();
                            return;
                        }
                        
                        const messages = [];
                        snapshot.forEach((doc) => {
                            messages.push({ id: doc.id, ...doc.data() });
                        });
                        
                        messages.sort((a, b) => {
                            const timeA = a.timestamp?.toDate ? a.timestamp.toDate() : new Date(a.timestamp);
                            const timeB = b.timestamp?.toDate ? b.timestamp.toDate() : new Date(b.timestamp);
                            return timeA - timeB;
                        });
                        
                        messages.forEach((message) => {
                            addMessageToChat(message);
                        });
                        
                        scrollChatToBottom();
                    });
            }

            function scrollChatToBottom() {
                setTimeout(() => {
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 100);
            }

            function addMessageToChat(message) {
                const messageElement = document.createElement('div');
                messageElement.className = 'message';
                messageElement.setAttribute('data-message-id', message.id);
                
                if (message.isRadioShare) {
                    messageElement.classList.add('share-radio-message');
                }
                
                let timeString = 'Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‡Ñ‚Ð¾';
                if (message.timestamp) {
                    const time = message.timestamp.toDate ? message.timestamp.toDate() : new Date(message.timestamp);
                    timeString = time.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
                }
                
                let messageContent = '';
                
                if (message.replyTo) {
                    messageContent += `
                        <div class="reply-indicator">
                            ÐžÑ‚Ð²ÐµÑ‚ Ð½Ð°: <strong>${message.replyTo.userName || message.replyTo.user}</strong>: ${message.replyTo.text ? message.replyTo.text.substring(0, 30) + (message.replyTo.text.length > 30 ? '...' : '') : ''}
                        </div>
                    `;
                }
                
                if (message.gif) {
                    messageContent += `
                        <span class="message-user">${message.userName || 'ÐÐ½Ð¾Ð½Ð¸Ð¼'}:</span>
                        <img src="${message.gif}" style="max-width: 200px; border-radius: 8px; margin-top: 5px;" alt="GIF">
                        <span class="message-time">${timeString}</span>
                    `;
                } else if (message.isRadioShare && message.radioStation) {
                    messageContent += `
                        <span class="share-radio-icon"><i class="fas fa-radio"></i></span>
                        <span class="message-user">${message.userName || 'ÐÐ½Ð¾Ð½Ð¸Ð¼'}</span>
                        Ð¿Ð¾Ð´ÐµÐ»Ð¸Ð»ÑÑ Ñ€Ð°Ð´Ð¸Ð¾ÑÑ‚Ð°Ð½Ñ†Ð¸ÐµÐ¹:
                        <strong>${message.radioStation.name}</strong>
                        <span class="message-time">${timeString}</span>
                    `;
                } else {
                    const processedText = formatMessageText(message.text || '');
                    messageContent += `
                        <span class="message-user">${message.userName || 'ÐÐ½Ð¾Ð½Ð¸Ð¼'}:</span>
                        ${processedText}
                        <span class="message-time">${timeString}</span>
                    `;
                }
                
                let reactionsHTML = '';
                if (message.reactions && Object.keys(message.reactions).length > 0) {
                    reactionsHTML = '<div class="message-reactions">';
                    Object.entries(message.reactions).forEach(([emoji, users]) => {
                        const userCount = Object.keys(users).length;
                        if (userCount > 0) {
                            reactionsHTML += `
                                <div class="reaction" data-emoji="${emoji}" data-message-id="${message.id}">
                                    <span>${emoji}</span>
                                    <span class="reaction-count">${userCount}</span>
                                </div>
                            `;
                        }
                    });
                    reactionsHTML += '</div>';
                }
                
                messageElement.innerHTML = `
                    ${messageContent}
                    ${reactionsHTML}
                    <button class="reply-btn" data-message-id="${message.id}">
                        <i class="fas fa-reply"></i>
                    </button>
                    <button class="reaction-btn" data-message-id="${message.id}">
                        <i class="far fa-smile"></i>
                    </button>
                    <div class="reaction-picker" id="reaction-picker-${message.id}">
                        <span class="reaction-emoji" data-emoji="ðŸ‘">ðŸ‘</span>
                        <span class="reaction-emoji" data-emoji="â¤ï¸">â¤ï¸</span>
                        <span class="reaction-emoji" data-emoji="ðŸ˜‚">ðŸ˜‚</span>
                        <span class="reaction-emoji" data-emoji="ðŸ˜®">ðŸ˜®</span>
                        <span class="reaction-emoji" data-emoji="ðŸ˜¢">ðŸ˜¢</span>
                        <span class="reaction-emoji" data-emoji="ðŸŽµ">ðŸŽµ</span>
                        <span class="more-reactions-btn" data-message-id="${message.id}">â‹¯</span>
                    </div>
                `;
                
                chatMessages.appendChild(messageElement);
                
                const replyBtn = messageElement.querySelector('.reply-btn');
                replyBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    startReply(message);
                });
                
                const reactionElements = messageElement.querySelectorAll('.reaction');
                reactionElements.forEach(reaction => {
                    reaction.addEventListener('click', handleReactionClick);
                });
                
                const reactionBtn = messageElement.querySelector('.reaction-btn');
                reactionBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const picker = this.parentElement.querySelector('.reaction-picker');
                    if (picker) {
                        document.querySelectorAll('.reaction-picker').forEach(p => {
                            if (p !== picker) p.classList.remove('show');
                        });
                        picker.classList.toggle('show');
                    }
                });
                
                const emojiElements = messageElement.querySelectorAll('.reaction-emoji');
                emojiElements.forEach(emoji => {
                    emoji.addEventListener('click', function(e) {
                        e.stopPropagation();
                        addReactionToMessage(message.id, this.getAttribute('data-emoji'));
                        this.parentElement.classList.remove('show');
                    });
                });
                
                const moreReactionsBtn = messageElement.querySelector('.more-reactions-btn');
                moreReactionsBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    currentMessageForReaction = message.id;
                    reactionsModal.style.display = 'block';
                    this.parentElement.classList.remove('show');
                });
                
                if (message.isRadioShare && message.radioStation) {
                    messageElement.addEventListener('click', function() {
                        playSharedRadio(message.radioStation);
                    });
                }
                
                messageElement.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                    const picker = this.querySelector('.reaction-picker');
                    if (picker) {
                        document.querySelectorAll('.reaction-picker').forEach(p => {
                            if (p !== picker) p.classList.remove('show');
                        });
                        picker.classList.toggle('show');
                    }
                });
            }
            
            function formatMessageText(text) {
                if (!text) return '';
                
                const urlRegex = /(https?:\/\/[^\s]+)/g;
                
                return text.replace(urlRegex, function(url) {
                    return '<a href="' + url + '" target="_blank">' + url + '</a>';
                });
            }
            
            function startReply(message) {
                replyingToMessage = message;
                
                const replyIndicator = document.createElement('div');
                replyIndicator.className = 'reply-indicator';
                replyIndicator.innerHTML = `
                    ÐžÑ‚Ð²ÐµÑ‚ Ð½Ð°: <strong>${message.userName || message.user}</strong>: ${message.text ? message.text.substring(0, 30) + (message.text.length > 30 ? '...' : '') : ''}
                    <button class="cancel-reply">âœ•</button>
                `;
                
                const existingIndicator = document.querySelector('.reply-indicator:not(.message .reply-indicator)');
                if (existingIndicator) {
                    existingIndicator.remove();
                }
                
                const chatInputContainer = document.getElementById('chat-input-container');
                chatInputContainer.parentNode.insertBefore(replyIndicator, chatInputContainer);
                
                const cancelBtn = replyIndicator.querySelector('.cancel-reply');
                cancelBtn.addEventListener('click', cancelReply);
                
                chatInput.focus();
            }
            
            function cancelReply() {
                replyingToMessage = null;
                const replyIndicator = document.querySelector('.reply-indicator:not(.message .reply-indicator)');
                if (replyIndicator) {
                    replyIndicator.remove();
                }
            }
            
            function handleReactionClick(e) {
                e.stopPropagation();
                const messageId = this.getAttribute('data-message-id');
                const emoji = this.getAttribute('data-emoji');
                addReactionToMessage(messageId, emoji);
            }
            
            function addReactionToMessage(messageId, emoji) {
                const user = auth.currentUser;
                const userId = user ? user.uid : 'anonymous';
                
                db.collection('chat').doc(messageId).get().then(doc => {
                    if (doc.exists) {
                        const message = doc.data();
                        const reactions = message.reactions || {};
                        const userReactions = reactions[emoji] || {};
                        
                        if (userReactions[userId]) {
                            delete userReactions[userId];
                            if (Object.keys(userReactions).length === 0) {
                                delete reactions[emoji];
                            } else {
                                reactions[emoji] = userReactions;
                            }
                        } else {
                            userReactions[userId] = true;
                            reactions[emoji] = userReactions;
                        }
                        
                        db.collection('chat').doc(messageId).update({
                            reactions: reactions
                        });
                    }
                });
            }

            function sendMessage() {
                const user = auth.currentUser;
                const messageText = chatInput.value.trim();
                if (messageText === '') return;
                
                const displayName = userNickname || (user ? (user.displayName || 'ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ') : 'ÐÐ½Ð¾Ð½Ð¸Ð¼');
                
                const message = {
                    text: messageText,
                    userName: displayName,
                    userId: user ? user.uid : 'anonymous',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    reactions: {}
                };
                
                if (replyingToMessage) {
                    message.replyTo = {
                        userName: replyingToMessage.userName || replyingToMessage.user,
                        text: replyingToMessage.text,
                        messageId: replyingToMessage.id
                    };
                }
                
                chatSendBtn.disabled = true;
                chatSendBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                
                db.collection('chat').add(message)
                    .then(() => {
                        chatInput.value = '';
                        cancelReply();
                    })
                    .finally(() => {
                        chatSendBtn.disabled = false;
                        chatSendBtn.innerHTML = '<i class="fas fa-paper-plane"></i>';
                    });
            }
            
            function playSharedRadio(radioStation) {
                const stationKey = Object.keys(radioStations).find(key => 
                    radioStations[key].name === radioStation.name
                );
                
                if (stationKey) {
                    const stationIndex = stationIds.indexOf(stationKey);
                    if (stationIndex !== -1) {
                        currentStationIndex = stationIndex;
                        currentStation = stationKey;
                        isPlaying = true;
                        playButton.innerHTML = '<i class="fas fa-pause"></i>';
                        document.getElementById('player-icon').classList.add('playing');
                        changeStation();
                        showNotification(`Ð’ÐºÐ»ÑŽÑ‡ÐµÐ½Ð° ÑÑ‚Ð°Ð½Ñ†Ð¸Ñ: ${radioStation.name}`, 'success');
                    }
                } else {
                    showNotification('Ð¡Ñ‚Ð°Ð½Ñ†Ð¸Ñ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð° Ð² ÑÐ¿Ð¸ÑÐºÐµ', 'error');
                }
            }
            
            function shareRadioInChat() {
                const user = auth.currentUser;
                if (!user) {
                    showNotification('Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ Ñ€Ð°Ð´Ð¸Ð¾ Ð² Ñ‡Ð°Ñ‚', 'error');
                    shareModal.style.display = 'none';
                    return;
                }
                
                if (!currentStation) {
                    showNotification('Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ€Ð°Ð´Ð¸Ð¾ÑÑ‚Ð°Ð½Ñ†Ð¸ÑŽ', 'error');
                    shareModal.style.display = 'none';
                    return;
                }
                
                const displayName = userNickname || (user.displayName || 'ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ');
                const station = radioStations[currentStation];
                
                const message = {
                    userName: displayName,
                    userId: user.uid,
                    isRadioShare: true,
                    radioStation: station,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    reactions: {}
                };
                
                db.collection('chat').add(message)
                    .then(() => {
                        shareModal.style.display = 'none';
                        showNotification('Ð Ð°Ð´Ð¸Ð¾ÑÑ‚Ð°Ð½Ñ†Ð¸Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð° Ð² Ñ‡Ð°Ñ‚!', 'success');
                    })
                    .catch(error => {
                        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ñ€Ð°Ð´Ð¸Ð¾ Ð² Ñ‡Ð°Ñ‚:', error);
                        showNotification('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸', 'error');
                    });
            }
            
            function changeGif() {
                let randomGif;
                if (currentStation === 'minecraft') {
                    randomGif = minecraftGifs[Math.floor(Math.random() * minecraftGifs.length)];
                } else {
                    randomGif = gifs[Math.floor(Math.random() * gifs.length)];
                }
                
                mainGif.classList.add('gif-transition');
                
                setTimeout(() => {
                    mainGif.style.backgroundImage = `url('${randomGif}')`;
                    
                    setTimeout(() => {
                        mainGif.classList.remove('gif-transition');
                    }, 600);
                }, 300);
            }
            
            function sortStationsByLikes() {
                const allStations = Object.keys(radioStations);
                const sortedStations = [...allStations].sort((a, b) => {
                    const likesA = stationLikes[a] ? stationLikes[a].count || 0 : 0;
                    const likesB = stationLikes[b] ? stationLikes[b].count || 0 : 0;
                    return likesB - likesA;
                });
                
                return sortedStations;
            }
            
            function displayTopStations() {
                const sortedStations = sortStationsByLikes();
                
                stationList.innerHTML = '';
                
                const topTitle = document.createElement('div');
                topTitle.className = 'category-title';
                topTitle.textContent = 'Ð›ÑƒÑ‡ÑˆÐ¸Ðµ Ð¿Ð¾ Ð»Ð°Ð¹ÐºÐ°Ð¼';
                stationList.appendChild(topTitle);
                
                sortedStations.forEach(stationId => {
                    const stationData = radioStations[stationId];
                    const stationItem = document.createElement('li');
                    stationItem.setAttribute('data-station', stationId);
                    
                    if (stationData.isChristmas) {
                        stationItem.className = 'christmas-garland';
                    } else {
                        stationItem.className = stationData.isChristmas ? 'christmas' : '';
                    }
                    
                    if (stationId === currentStation) {
                        stationItem.classList.add('active');
                    }
                    
                    const likesCount = stationLikes[stationId] ? stationLikes[stationId].count || 0 : 0;
                    
                    stationItem.innerHTML = `
                        <div style="display: flex; align-items: center;">
                            <span class="station-icon"><i class="${stationData.icon}"></i></span> ${stationData.name}
                        </div>
                        <div class="station-likes">
                            <span class="likes-count">${likesCount}</span> <i class="fas fa-heart"></i>
                        </div>
                    `;
                    
                    stationItem.addEventListener('click', function() {
                        const stationId = this.getAttribute('data-station');
                        currentStationIndex = stationIds.indexOf(stationId);
                        isPlaying = true;
                        playButton.innerHTML = '<i class="fas fa-pause"></i>';
                        document.getElementById('player-icon').classList.add('playing');
                        changeStation();
                    });
                    
                    stationList.appendChild(stationItem);
                });
            }
            
            function restoreOriginalStationOrder() {
                loadStationList();
                updateLikesUI();
                
                const stationItems = document.querySelectorAll('.station-list li');
                stationItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-station') === currentStation) {
                        item.classList.add('active');
                    }
                });
            }
            
            function filterStationsByCategory(category) {
                if (category === 'top') {
                    displayTopStations();
                    return;
                } else {
                    restoreOriginalStationOrder();
                }
                
                const stationItems = document.querySelectorAll('.station-list li');
                stationItems.forEach(item => {
                    const stationId = item.getAttribute('data-station');
                    const station = radioStations[stationId];
                    
                    if (category === 'all' || 
                        (category === 'lofi' && station.category === 'lofi') ||
                        (category === 'thematic' && station.category === 'thematic') ||
                        (category === 'no-copyright' && station.category === 'no-copyright')) {
                        item.style.display = 'flex';
                        if (item.previousElementSibling && item.previousElementSibling.classList.contains('category-title')) {
                            item.previousElementSibling.style.display = 'block';
                        }
                    } else {
                        item.style.display = 'none';
                    }
                });
                
                document.querySelectorAll('.category-title').forEach(title => {
                    const nextSibling = title.nextElementSibling;
                    if (!nextSibling || nextSibling.style.display === 'none') {
                        let hasVisible = false;
                        let sibling = title.nextElementSibling;
                        while (sibling && !sibling.classList.contains('category-title')) {
                            if (sibling.style.display !== 'none') {
                                hasVisible = true;
                                break;
                            }
                            sibling = sibling.nextElementSibling;
                        }
                        if (!hasVisible) {
                            title.style.display = 'none';
                        } else {
                            title.style.display = 'block';
                        }
                    }
                });
            }
            
            chatInput.addEventListener('input', function() {
                chatSendBtn.disabled = this.value.trim() === '';
            });
            
            chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !chatSendBtn.disabled) {
                    sendMessage();
                }
            });
            
            chatSendBtn.addEventListener('click', function() {
                sendMessage();
            });
            
            shareBtn.addEventListener('click', function() {
                shareModal.style.display = 'block';
            });
            
            closeShareModal.addEventListener('click', function() {
                shareModal.style.display = 'none';
            });
            
            copyLinkBtn.addEventListener('click', function() {
                navigator.clipboard.writeText('https://deyniik.github.io/DeynikRadio/')
                    .then(() => {
                        showNotification('Ð¡ÑÑ‹Ð»ÐºÐ° ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° Ð² Ð±ÑƒÑ„ÐµÑ€ Ð¾Ð±Ð¼ÐµÐ½Ð°!', 'success');
                        shareModal.style.display = 'none';
                    })
                    .catch(() => {
                        showNotification('ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑÑ‹Ð»ÐºÑƒ', 'error');
                    });
            });
            
            shareInChatBtn.addEventListener('click', shareRadioInChat);
            
            supportBtn.addEventListener('click', function() {
                supportModal.style.display = 'block';
            });
            
            closeSupportModal.addEventListener('click', function() {
                supportModal.style.display = 'none';
            });
            
            closeSupportBtn.addEventListener('click', function() {
                supportModal.style.display = 'none';
            });
            
            closeReactionsModal.addEventListener('click', function() {
                reactionsModal.style.display = 'none';
            });
            
            closeNicknameModal.addEventListener('click', function() {
                nicknameModal.style.display = 'none';
            });
            
            cancelNicknameBtn.addEventListener('click', function() {
                nicknameModal.style.display = 'none';
            });
            
            saveNicknameBtn.addEventListener('click', saveNickname);
            
            nicknameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') saveNickname();
            });
            
            feedbackBtn.addEventListener('click', function() {
                feedbackModal.style.display = 'block';
            });
            
            closeFeedbackModal.addEventListener('click', function() {
                feedbackModal.style.display = 'none';
            });
            
            window.addEventListener('click', function(event) {
                if (event.target === shareModal) {
                    shareModal.style.display = 'none';
                }
                if (event.target === reactionsModal) {
                    reactionsModal.style.display = 'none';
                }
                if (event.target === nicknameModal) {
                    nicknameModal.style.display = 'none';
                }
                if (event.target === feedbackModal) {
                    feedbackModal.style.display = 'none';
                }
                if (event.target === supportModal) {
                    supportModal.style.display = 'none';
                }
                if (event.target === pwaInstallPrompt) {
                    hidePWAInstallPrompt();
                }
            });
            
            emojiBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                emojiPicker.classList.toggle('show');
                gifPicker.classList.remove('show');
            });
            
            gifBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                gifPicker.classList.toggle('show');
                emojiPicker.classList.remove('show');
            });
            
            emojiSearch.addEventListener('input', function(e) {
                e.stopPropagation();
                filterEmojis();
            });
            
            emojiCategoryBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    emojiCategoryBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    filterEmojisByCategory(this.dataset.category);
                });
            });
            
            gifSearch.addEventListener('input', function(e) {
                e.stopPropagation();
                searchGifs();
            });
            
            gifTrendingBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    searchGifs(this.dataset.term);
                });
            });
            
            document.addEventListener('click', function() {
                emojiPicker.classList.remove('show');
                gifPicker.classList.remove('show');
                document.querySelectorAll('.reaction-picker').forEach(picker => {
                    picker.classList.remove('show');
                });
            });
            
            emojiPicker.addEventListener('click', function(e) {
                e.stopPropagation();
            });
            
            gifPicker.addEventListener('click', function(e) {
                e.stopPropagation();
            });
            
            categoryBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    categoryBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    const category = btn.dataset.category;
                    filterStationsByCategory(category);
                });
            });
            
            auth.onAuthStateChanged(updateAuthUI);
            
            likeButton.addEventListener('click', toggleLike);
            
            playButton.addEventListener('click', function() {
                isPlaying = !isPlaying;
                
                if (isPlaying) {
                    playButton.innerHTML = '<i class="fas fa-pause"></i>';
                    document.getElementById('player-icon').classList.add('playing');
                    if (!audio) {
                        audio = new Audio(radioStations[currentStation].url);
                        audio.volume = volumeSlider.value / 100;
                    }
                    audio.play().catch(error => {
                        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ:', error);
                        isPlaying = false;
                        playButton.innerHTML = '<i class="fas fa-play"></i>';
                        document.getElementById('player-icon').classList.remove('playing');
                    });
                    playbackIndicator.style.opacity = '1';
                    startVisualization();
                } else {
                    playButton.innerHTML = '<i class="fas fa-play"></i>';
                    document.getElementById('player-icon').classList.remove('playing');
                    if (audio) audio.pause();
                    playbackIndicator.style.opacity = '0';
                    stopVisualization();
                }
            });
            
            randomStationBtn.addEventListener('click', function() {
                currentStationIndex = Math.floor(Math.random() * stationIds.length);
                isPlaying = true;
                playButton.innerHTML = '<i class="fas fa-pause"></i>';
                document.getElementById('player-icon').classList.add('playing');
                changeStation();
            });
            
            prevButton.addEventListener('click', function() {
                currentStationIndex = (currentStationIndex - 1 + stationIds.length) % stationIds.length;
                isPlaying = true;
                playButton.innerHTML = '<i class="fas fa-pause"></i>';
                document.getElementById('player-icon').classList.add('playing');
                changeStation();
            });
            
            nextButton.addEventListener('click', function() {
                currentStationIndex = (currentStationIndex + 1) % stationIds.length;
                isPlaying = true;
                playButton.innerHTML = '<i class="fas fa-pause"></i>';
                document.getElementById('player-icon').classList.add('playing');
                changeStation();
            });
            
            refreshButton.addEventListener('click', function() {
                this.classList.add('reload-animation');
                setTimeout(() => {
                    this.classList.remove('reload-animation');
                }, 500);
                
                if (audio) {
                    const wasPlaying = !audio.paused;
                    audio.pause();
                    audio = new Audio(radioStations[currentStation].url + '?nocache=' + new Date().getTime());
                    audio.volume = volumeSlider.value / 100;
                    
                    if (wasPlaying) {
                        isPlaying = true;
                        playButton.innerHTML = '<i class="fas fa-pause"></i>';
                        document.getElementById('player-icon').classList.add('playing');
                        
                        audio.play().catch(error => {
                            console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ:', error);
                            isPlaying = false;
                            playButton.innerHTML = '<i class="fas fa-play"></i>';
                            document.getElementById('player-icon').classList.remove('playing');
                        });
                    } else {
                        isPlaying = false;
                        playButton.innerHTML = '<i class="fas fa-play"></i>';
                        document.getElementById('player-icon').classList.remove('playing');
                    }
                    
                    changeGif();
                    showNotification('Ð¡Ñ‚Ð°Ð½Ñ†Ð¸Ñ Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð°', 'success');
                }
            });
            
            function changeStation() {
                currentStation = stationIds[currentStationIndex];
                updateStationInfo();
                
                const stationItems = document.querySelectorAll('.station-list li');
                stationItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-station') === currentStation) {
                        item.classList.add('active');
                    }
                });
                
                if (currentStation === 'minecraft') {
                    minecraftLoading.style.display = 'block';
                } else {
                    minecraftLoading.style.display = 'none';
                }
                
                if (isPlaying) {
                    if (audio) audio.pause();
                    audio = new Audio(radioStations[currentStation].url);
                    audio.volume = volumeSlider.value / 100;
                    audio.play().then(() => {
                        minecraftLoading.style.display = 'none';
                    }).catch(error => {
                        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ:', error);
                        if (currentStation === 'minecraft') {
                            minecraftLoading.style.display = 'block';
                        }
                    });
                    playbackIndicator.style.opacity = '1';
                    startVisualization();
                }
                
                changeGif();
                updateLikesUI();
            }
            
            function updateStationInfo() {
                const station = radioStations[currentStation];
                document.getElementById('current-station').textContent = station.name;
                document.getElementById('current-track-info').textContent = station.currentTrack;
                document.getElementById('current-artist-info').textContent = station.currentArtist;
                document.getElementById('quality').textContent = station.quality;
                document.getElementById('player-station').textContent = station.name;
                document.getElementById('player-description').textContent = station.description;
                document.getElementById('player-icon').innerHTML = `<i class="${station.icon}"></i>`;
                document.getElementById('current-track').textContent = station.currentTrack;
                document.getElementById('current-artist').textContent = station.currentArtist;
            }
            
            function startVisualization() {
                if (visualizationInterval) clearInterval(visualizationInterval);
                visualizationInterval = setInterval(() => {
                    bars.forEach(bar => {
                        bar.style.height = `${Math.floor(Math.random() * 30) + 1}px`;
                    });
                }, 100);
            }
            
            function stopVisualization() {
                if (visualizationInterval) clearInterval(visualizationInterval);
                bars.forEach(bar => bar.style.height = '2px');
            }
            
            document.addEventListener('click', function() {
                const dropdown = document.getElementById('user-dropdown');
                if (dropdown) dropdown.classList.remove('show');
            });
        }
    </script>
</body>
</html>
